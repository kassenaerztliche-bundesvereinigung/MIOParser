/*
 *  Licensed to the Kassen√§rztliche Bundesvereinigung (KBV) (c) 2020 - 2022 under one
 *  or more contributor license agreements. See the NOTICE file
 *  distributed with this work for additional information
 *  regarding copyright ownership. The KBV licenses this file
 *  to you under the Apache License, Version 2.0 (the
 *  "License"); you may not use this file except in compliance
 *  with the License. You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 *   Unless required by applicable law or agreed to in writing,
 *  software distributed under the License is distributed on an
 *  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 *  KIND, either express or implied. See the License for the
 *  specific language governing permissions and limitations
 *  under the License.
 *
 */

import * as Vaccination from "../KBV/IM/";
import { VaccinationResource } from "./VaccinationResource";
import * as ZAEB from "../KBV/ZB/";
import { ZAEBResource } from "./ZAEBResource";
import * as MR from "../KBV/MR/";
import { MRResource } from "./MRResource";
import * as CMR from "../KBV/CMR/";
import { CMRResource } from "./CMRResource";
import * as PN from "../KBV/CMR/";
import { PNResource } from "./PNResource";
import * as PC from "../KBV/CMR/";
import { PCResource } from "./PCResource";
import * as NFDxDPE from "../KBV/PKA/";
import { NFDxDPEResource } from "./NFDxDPEResource";
import * as NFD from "../KBV/PKA/";
import { NFDResource } from "./NFDResource";
import * as DPE from "../KBV/PKA/";
import { DPEResource } from "./DPEResource";
import * as PS from "../KBV/PS/";
import { PSResource } from "./PSResource";

export type KBVResource =
    | VaccinationResource
    | ZAEBResource
    | MRResource
    | CMRResource
    | PNResource
    | PCResource
    | NFDxDPEResource
    | NFDResource
    | DPEResource
    | PSResource;

export type MIOType = Readonly<{
    profile: string;
    type: any; // eslint-disable-line @typescript-eslint/no-explicit-any
    version: string;
    constraints?: any; // eslint-disable-line @typescript-eslint/no-explicit-any
}>;

export type KBVBundleResource =
    | Vaccination.V1_1_0.Profile.BundleEntry
    | ZAEB.V1_1_0.Profile.Bundle
    | MR.V1_0_0.Profile.Bundle
    | MR.V1_1_0.Profile.Bundle
    | CMR.V1_0_1.Profile.CMRBundle
    | PN.V1_0_1.Profile.PNBundle
    | PC.V1_0_1.Profile.PCBundle
    | NFDxDPE.V1_0_0.Profile.NFDxDPEBundle
    | PS.V1_0_0.Profile.Bundle;

export type MIOTypeList = MIOType[];
export const BundleTypes: MIOTypeList = [
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Bundle_Entry",
        type: Vaccination.V1_1_0.Profile.BundleEntry,
        version: "1.1.0"
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Bundle",
        type: ZAEB.V1_1_0.Profile.Bundle,
        version: "1.1.0"
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Bundle",
        type: MR.V1_0_0.Profile.Bundle,
        version: "1.0.0"
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Bundle",
        type: MR.V1_1_0.Profile.Bundle,
        version: "1.1.0"
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Bundle",
        type: CMR.V1_0_1.Profile.CMRBundle,
        version: "1.0.1"
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PC_Bundle",
        type: PC.V1_0_1.Profile.PCBundle,
        version: "1.0.1"
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PN_Bundle",
        type: PN.V1_0_1.Profile.PNBundle,
        version: "1.0.1"
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFDxDPE_Bundle",
        type: NFDxDPE.V1_0_0.Profile.NFDxDPEBundle,
        version: "1.0.0"
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PS_Bundle",
        type: PS.V1_0_0.Profile.Bundle,
        version: "1.0.0"
    }
];

export const MIOTypes: MIOTypeList = [
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Bundle_Entry",
        type: Vaccination.V1_1_0.Profile.BundleEntry,
        version: "1.1.0",
        constraints: [
            {
                key: "bdl-7",
                severity: "error",
                human: "FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (except in history bundles)",
                expression:
                    "(type = 'history') or entry.where(fullUrl.exists()).select(fullUrl&resource.meta.versionId).isDistinct()",
                xpath: "(f:type/@value = 'history') or (count(for $entry in f:entry[f:resource] return $entry[count(parent::f:Bundle/f:entry[f:fullUrl/@value=$entry/f:fullUrl/@value and ((not(f:resource/*/f:meta/f:versionId/@value) and not($entry/f:resource/*/f:meta/f:versionId/@value)) or f:resource/*/f:meta/f:versionId/@value=$entry/f:resource/*/f:meta/f:versionId/@value)])!=1])=0)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-9",
                severity: "error",
                human: "A document must have an identifier with a system and a value",
                expression:
                    "type = 'document' implies (identifier.system.exists() and identifier.value.exists())",
                xpath: "not(f:type/@value = 'document') or exists(f:identifier/f:system) or exists(f:identifier/f:value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-3",
                severity: "error",
                human: "entry.request mandatory for batch/transaction/history, otherwise prohibited",
                expression:
                    "entry.all(request.exists() = (%resource.type = 'batch' or %resource.type = 'transaction' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:request) or (f:type/@value = 'batch') or (f:type/@value = 'transaction') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-4",
                severity: "error",
                human: "entry.response mandatory for batch-response/transaction-response/history, otherwise prohibited",
                expression:
                    "entry.all(response.exists() = (%resource.type = 'batch-response' or %resource.type = 'transaction-response' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:response) or (f:type/@value = 'batch-response') or (f:type/@value = 'transaction-response') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-12",
                severity: "error",
                human: "A message must have a MessageHeader as the first resource",
                expression:
                    "type = 'message' implies entry.first().resource.is(MessageHeader)",
                xpath: "not(f:type/@value='message') or f:entry[1]/f:resource/f:MessageHeader",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-1",
                severity: "error",
                human: "total only when a search or history",
                expression: "total.empty() or (type = 'searchset') or (type = 'history')",
                xpath: "not(f:total) or (f:type/@value = 'searchset') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-2",
                severity: "error",
                human: "entry.search only when a search",
                expression: "entry.search.empty() or (type = 'searchset')",
                xpath: "not(f:entry/f:search) or (f:type/@value = 'searchset')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-11",
                severity: "error",
                human: "A document must have a Composition as the first resource",
                expression:
                    "type = 'document' implies entry.first().resource.is(Composition)",
                xpath: "not(f:type/@value='document') or f:entry[1]/f:resource/f:Composition",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-10",
                severity: "error",
                human: "A document must have a date",
                expression: "type = 'document' implies (timestamp.hasValue())",
                xpath: "not(f:type/@value = 'document') or exists(f:timestamp/@value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "TypeComposition",
                severity: "error",
                human: "Es muss genau eine Composition_Prime oder Composition_Addendum enthalten sein",
                expression:
                    "entry.where(resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Composition_Prime|1.1.0' or resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Composition_Addendum|1.1.0').count()=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Bundle_Entry"
            },
            {
                key: "OneComposition",
                severity: "error",
                human: "Es darf genau eine Composition geben",
                expression: "entry.select(resource as Composition).count()=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Bundle_Entry"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Composition_Addendum",
        type: Vaccination.V1_1_0.Profile.CompositionAddendum,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Composition_Prime",
        type: Vaccination.V1_1_0.Profile.CompositionPrime,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Condition",
        type: Vaccination.V1_1_0.Profile.Condition,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "con-5",
                severity: "error",
                human: "Condition.clinicalStatus SHALL NOT be present if verification Status is entered-in-error",
                expression:
                    "verificationStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-ver-status' and code='entered-in-error').empty() or clinicalStatus.empty()",
                xpath: "not(exists(f:verificationStatus/f:coding[f:system/@value='http://terminology.hl7.org/CodeSystem/condition-ver-status' and f:code/@value='entered-in-error'])) or not(exists(f:clinicalStatus))",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                key: "con-4",
                severity: "error",
                human: "If condition is abated, then clinicalStatus must be either inactive, resolved, or remission",
                expression:
                    "abatement.empty() or clinicalStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-clinical' and (code='resolved' or code='remission' or code='inactive')).exists()",
                xpath: "not(exists(*[starts-with(local-name(.), 'abatement')])) or exists(f:clinicalStatus/f:coding[f:system/@value='http://terminology.hl7.org/CodeSystem/condition-clinical' and f:code/@value=('resolved', 'remission', 'inactive')])",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "Most systems will expect a clinicalStatus to be valued for problem-list-items that are managed over time, but might not need a clinicalStatus for point in time encounter-diagnosis."
                    }
                ],
                key: "con-3",
                severity: "warning",
                human: "Condition.clinicalStatus SHALL be present if verificationStatus is not entered-in-error and category is problem-list-item",
                expression:
                    "clinicalStatus.exists() or verificationStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-ver-status' and code = 'entered-in-error').exists() or category.select($this='problem-list-item').empty()",
                xpath: "exists(f:clinicalStatus) or exists(f:verificationStatus/f:coding/f:code/@value='entered-in-error') or not(exists(category[@value='problem-list-item']))",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                key: "Cond1",
                severity: "error",
                human: "Das Dokumentationsdatum muss mindestens mit TT.MM.JJJJ angegeben werden",
                expression: "recordedDate.toString().length()>=10",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Condition"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Observation_Immunization_Status",
        type: Vaccination.V1_1_0.Profile.ObservationImmunizationStatus,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "issued",
                severity: "error",
                human: "Das Untersuchungsdatum muss mindestens JJJJ-MM Stellen haben",
                expression: "issued.toString().length()>=7",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Observation_Immunization_Status"
            },
            {
                key: "Code",
                severity: "error",
                human: "Wenn der Code 26268376005 oder 268375009 oder 440662009 oder 440661002 ausgew√§hlt wurde, dann kann die Immunit√§t angegeben werden, ansonsten muss die Immunit√§t angegeben werden.",
                expression:
                    "code.coding.where(system='http://snomed.info/sct' and (code!='268376005' and code!='268375009' and code!='440662009' and code!='440661002')).exists() implies interpretation.exists()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Observation_Immunization_Status"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Organization",
        type: Vaccination.V1_1_0.Profile.Organization,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "org-1",
                severity: "error",
                human: "The organization SHALL at least have a name or an identifier, and possibly more than one",
                expression: "(identifier.count() + name.count()) > 0",
                xpath: "count(f:identifier | f:name) > 0",
                source: "http://hl7.org/fhir/StructureDefinition/Organization"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Organization_Addendum",
        type: Vaccination.V1_1_0.Profile.OrganizationAddendum,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "org-1",
                severity: "error",
                human: "The organization SHALL at least have a name or an identifier, and possibly more than one",
                expression: "(identifier.count() + name.count()) > 0",
                xpath: "count(f:identifier | f:name) > 0",
                source: "http://hl7.org/fhir/StructureDefinition/Organization"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Patient",
        type: Vaccination.V1_1_0.Profile.Patient,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pat-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de').empty()",
                source: "http://fhir.de/StructureDefinition/Patient"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Practitioner",
        type: Vaccination.V1_1_0.Profile.Practitioner,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pract-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de/0.2').empty()",
                source: "http://fhir.de/StructureDefinition/Practitioner"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Practitionerrole",
        type: Vaccination.V1_1_0.Profile.Practitionerrole,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Practitionerrole_Addendum",
        type: Vaccination.V1_1_0.Profile.PractitionerroleAddendum,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Practitioner_Addendum",
        type: Vaccination.V1_1_0.Profile.PractitionerAddendum,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pract-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de/0.2').empty()",
                source: "http://fhir.de/StructureDefinition/Practitioner"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Provenance",
        type: Vaccination.V1_1_0.Profile.Provenance,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Record_Addendum",
        type: Vaccination.V1_1_0.Profile.RecordAddendum,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Record_Prime",
        type: Vaccination.V1_1_0.Profile.RecordPrime,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "Occurrence",
                severity: "error",
                human: "Das Impfdatum muss mindestens aus TT.MM.JJJJ",
                expression: "occurrenceDateTime.toString().length()>=10",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Record_Prime"
            },
            {
                key: "atc1",
                severity: "error",
                human: "Nur bei Angabe des Snomed Codes 787859002 Sonstiger Impfstoff (hier nicht gelistet) muss kein ATC-Code angeben werden.",
                expression:
                    "vaccineCode.coding.where(system='http://snomed.info/sct' and code!='787859002').exists() implies vaccineCode.coding.where(system='http://fhir.de/CodeSystem/dimdi/atc').exists()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_Vaccination_Record_Prime"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Bundle",
        type: ZAEB.V1_1_0.Profile.Bundle,
        version: "1.1.0",
        constraints: [
            {
                key: "bdl-7",
                severity: "error",
                human: "FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (except in history bundles)",
                expression:
                    "(type = 'history') or entry.where(fullUrl.exists()).select(fullUrl&resource.meta.versionId).isDistinct()",
                xpath: "(f:type/@value = 'history') or (count(for $entry in f:entry[f:resource] return $entry[count(parent::f:Bundle/f:entry[f:fullUrl/@value=$entry/f:fullUrl/@value and ((not(f:resource/*/f:meta/f:versionId/@value) and not($entry/f:resource/*/f:meta/f:versionId/@value)) or f:resource/*/f:meta/f:versionId/@value=$entry/f:resource/*/f:meta/f:versionId/@value)])!=1])=0)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-9",
                severity: "error",
                human: "A document must have an identifier with a system and a value",
                expression:
                    "type = 'document' implies (identifier.system.exists() and identifier.value.exists())",
                xpath: "not(f:type/@value = 'document') or exists(f:identifier/f:system) or exists(f:identifier/f:value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-3",
                severity: "error",
                human: "entry.request mandatory for batch/transaction/history, otherwise prohibited",
                expression:
                    "entry.all(request.exists() = (%resource.type = 'batch' or %resource.type = 'transaction' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:request) or (f:type/@value = 'batch') or (f:type/@value = 'transaction') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-4",
                severity: "error",
                human: "entry.response mandatory for batch-response/transaction-response/history, otherwise prohibited",
                expression:
                    "entry.all(response.exists() = (%resource.type = 'batch-response' or %resource.type = 'transaction-response' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:response) or (f:type/@value = 'batch-response') or (f:type/@value = 'transaction-response') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-12",
                severity: "error",
                human: "A message must have a MessageHeader as the first resource",
                expression:
                    "type = 'message' implies entry.first().resource.is(MessageHeader)",
                xpath: "not(f:type/@value='message') or f:entry[1]/f:resource/f:MessageHeader",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-1",
                severity: "error",
                human: "total only when a search or history",
                expression: "total.empty() or (type = 'searchset') or (type = 'history')",
                xpath: "not(f:total) or (f:type/@value = 'searchset') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-2",
                severity: "error",
                human: "entry.search only when a search",
                expression: "entry.search.empty() or (type = 'searchset')",
                xpath: "not(f:entry/f:search) or (f:type/@value = 'searchset')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-11",
                severity: "error",
                human: "A document must have a Composition as the first resource",
                expression:
                    "type = 'document' implies entry.first().resource.is(Composition)",
                xpath: "not(f:type/@value='document') or f:entry[1]/f:resource/f:Composition",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-10",
                severity: "error",
                human: "A document must have a date",
                expression: "type = 'document' implies (timestamp.hasValue())",
                xpath: "not(f:type/@value = 'document') or exists(f:timestamp/@value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "TypeComposition",
                severity: "error",
                human: "Es muss genau eine Composition enthalten sein",
                expression:
                    "entry.where(resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Composition|1.1.0').count()=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Bundle"
            },
            {
                key: "OneComposition",
                severity: "error",
                human: "Es darf genau eine Composition geben",
                expression: "entry.where(resource as Composition).count()=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Bundle"
            },
            {
                key: "OneObservation",
                severity: "error",
                human: "Es darf maximal eine Observation_Dental_Check_Up geben",
                expression:
                    "entry.where(resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Observation_Dental_Check_Up|1.1.0').count()=1 or entry.where(resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Observation_Dental_Check_Up|1.1.0').count()=0",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Bundle"
            },
            {
                key: "OneGaplessDocumentation",
                severity: "error",
                human: "Es darf maximal eine Observation_Gapless_Documentation geben",
                expression:
                    "entry.where(resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Observation_Gapless_Documentation|1.1.0').count()=1 or entry.where(resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Observation_Gapless_Documentation|1.1.0').count()=0",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Bundle"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Composition",
        type: ZAEB.V1_1_0.Profile.Composition,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Observation_Dental_Check_Up",
        type: ZAEB.V1_1_0.Profile.ObservationDentalCheckUp,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "effective",
                severity: "error",
                human: "Das Untersuchungsdatum muss mindestens 8 Stellen haben",
                expression: "effective.toString().length()>=8",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Observation_Dental_Check_Up"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Observation_Gapless_Documentation",
        type: ZAEB.V1_1_0.Profile.ObservationGaplessDocumentation,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Organization",
        type: ZAEB.V1_1_0.Profile.Organization,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "org-1",
                severity: "error",
                human: "The organization SHALL at least have a name or an identifier, and possibly more than one",
                expression: "(identifier.count() + name.count()) > 0",
                xpath: "count(f:identifier | f:name) > 0",
                source: "http://hl7.org/fhir/StructureDefinition/Organization"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_ZAEB_Patient",
        type: ZAEB.V1_1_0.Profile.Patient,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pat-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de').empty()",
                source: "http://fhir.de/StructureDefinition/Patient"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Appointment_Pregnancy",
        type: MR.V1_0_0.Profile.AppointmentPregnancy,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "app-4",
                severity: "error",
                human: "Cancelation reason is only used for appointments that have been cancelled, or no-show",
                expression:
                    "Appointment.cancelationReason.exists() implies (Appointment.status='no-show' or Appointment.status='cancelled')",
                xpath: "not(exists(f:cancellationReason)) or f:status/@value=('no-show', 'cancelled')",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-3",
                severity: "error",
                human: "Only proposed or cancelled appointments can be missing start/end dates",
                expression:
                    "(start.exists() and end.exists()) or (status in ('proposed' | 'cancelled' | 'waitlist'))",
                xpath: "((exists(f:start) and exists(f:end)) or (f:status/@value='proposed') or (f:status/@value='cancelled') or (f:status/@value='waitlist'))",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-2",
                severity: "error",
                human: "Either start and end are specified, or neither",
                expression: "start.exists() = end.exists()",
                xpath: "((exists(f:start) and exists(f:end)) or (not(exists(f:start)) and not(exists(f:end))))",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Bundle",
        type: MR.V1_0_0.Profile.Bundle,
        version: "1.0.0",
        constraints: [
            {
                key: "bdl-7",
                severity: "error",
                human: "FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (except in history bundles)",
                expression:
                    "(type = 'history') or entry.where(fullUrl.exists()).select(fullUrl&resource.meta.versionId).isDistinct()",
                xpath: "(f:type/@value = 'history') or (count(for $entry in f:entry[f:resource] return $entry[count(parent::f:Bundle/f:entry[f:fullUrl/@value=$entry/f:fullUrl/@value and ((not(f:resource/*/f:meta/f:versionId/@value) and not($entry/f:resource/*/f:meta/f:versionId/@value)) or f:resource/*/f:meta/f:versionId/@value=$entry/f:resource/*/f:meta/f:versionId/@value)])!=1])=0)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-9",
                severity: "error",
                human: "A document must have an identifier with a system and a value",
                expression:
                    "type = 'document' implies (identifier.system.exists() and identifier.value.exists())",
                xpath: "not(f:type/@value = 'document') or exists(f:identifier/f:system) or exists(f:identifier/f:value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-3",
                severity: "error",
                human: "entry.request mandatory for batch/transaction/history, otherwise prohibited",
                expression:
                    "entry.all(request.exists() = (%resource.type = 'batch' or %resource.type = 'transaction' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:request) or (f:type/@value = 'batch') or (f:type/@value = 'transaction') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-4",
                severity: "error",
                human: "entry.response mandatory for batch-response/transaction-response/history, otherwise prohibited",
                expression:
                    "entry.all(response.exists() = (%resource.type = 'batch-response' or %resource.type = 'transaction-response' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:response) or (f:type/@value = 'batch-response') or (f:type/@value = 'transaction-response') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-12",
                severity: "error",
                human: "A message must have a MessageHeader as the first resource",
                expression:
                    "type = 'message' implies entry.first().resource.is(MessageHeader)",
                xpath: "not(f:type/@value='message') or f:entry[1]/f:resource/f:MessageHeader",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-1",
                severity: "error",
                human: "total only when a search or history",
                expression: "total.empty() or (type = 'searchset') or (type = 'history')",
                xpath: "not(f:total) or (f:type/@value = 'searchset') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-2",
                severity: "error",
                human: "entry.search only when a search",
                expression: "entry.search.empty() or (type = 'searchset')",
                xpath: "not(f:entry/f:search) or (f:type/@value = 'searchset')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-11",
                severity: "error",
                human: "A document must have a Composition as the first resource",
                expression:
                    "type = 'document' implies entry.first().resource.is(Composition)",
                xpath: "not(f:type/@value='document') or f:entry[1]/f:resource/f:Composition",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-10",
                severity: "error",
                human: "A document must have a date",
                expression: "type = 'document' implies (timestamp.hasValue())",
                xpath: "not(f:type/@value = 'document') or exists(f:timestamp/@value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "OneComposition",
                severity: "error",
                human: "Es darf genau eine Composition geben",
                expression: "entry.where(ofType(Composition)).isDistinct()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Bundle"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Birth_Examination_Child_Information",
        type: MR.V1_0_0.Profile.ClinicalImpressionBirthExaminationChildInformation,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Birth_Examination_Delivery_Information",
        type: MR.V1_0_0.Profile.ClinicalImpressionBirthExaminationDeliveryInformation,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_First_Examination_After_Childbirth",
        type: MR.V1_0_0.Profile.ClinicalImpressionFirstExaminationAfterChildbirth,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Initial_Examination",
        type: MR.V1_0_0.Profile.ClinicalImpressionInitialExamination,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Pregnancy_Chart_Entry",
        type: MR.V1_0_0.Profile.ClinicalImpressionPregnancyChartEntry,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Pregnancy_Examination_Discharge_Summary",
        type: MR.V1_0_0.Profile.ClinicalImpressionPregnancyExaminationDischargeSummary,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Second_Examination_After_Childbirth",
        type: MR.V1_0_0.Profile.ClinicalImpressionSecondExaminationAfterChildbirth,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Composition",
        type: MR.V1_0_0.Profile.Composition,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_DiagnosticReport_Ultrasound_I",
        type: MR.V1_0_0.Profile.DiagnosticReportUltrasoundI,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_DiagnosticReport_Ultrasound_II",
        type: MR.V1_0_0.Profile.DiagnosticReportUltrasoundII,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_DiagnosticReport_Ultrasound_III",
        type: MR.V1_0_0.Profile.DiagnosticReportUltrasoundIII,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Encounter_Arrival_Maternity_Hospital",
        type: MR.V1_0_0.Profile.EncounterArrivalMaternityHospital,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Encounter_General",
        type: MR.V1_0_0.Profile.EncounterGeneral,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Encounter_Inpatient_Treatment",
        type: MR.V1_0_0.Profile.EncounterInpatientTreatment,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Abnormalities",
        type: MR.V1_0_0.Profile.ObservationAbnormalities,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Advice_On_Iodine_Intake",
        type: MR.V1_0_0.Profile.ObservationAdviceOnIodineIntake,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Age",
        type: MR.V1_0_0.Profile.ObservationAge,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Anti_D_Prophylaxis_Post_Partum",
        type: MR.V1_0_0.Profile.ObservationAntiDProphylaxisPostPartum,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Apgar_Score",
        type: MR.V1_0_0.Profile.ObservationApgarScore,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Baseline_Weight_Mother",
        type: MR.V1_0_0.Profile.ObservationBaselineWeightMother,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "weight-1",
                severity: "error",
                human: "When Observation.vlaue[x] is not present, Observation.dataAbsentReason SHALL be present",
                expression: "value.empty() implies dataAbsentReason.empty()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_Base_BodyWeight_Max"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Biometrics_I",
        type: MR.V1_0_0.Profile.ObservationBiometricsI,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Biometrics_II",
        type: MR.V1_0_0.Profile.ObservationBiometricsII,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Biometrics_III",
        type: MR.V1_0_0.Profile.ObservationBiometricsIII,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Birth_Height",
        type: MR.V1_0_0.Profile.ObservationBirthHeight,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Birth_Mode",
        type: MR.V1_0_0.Profile.ObservationBirthMode,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Blood_Group_Serology",
        type: MR.V1_0_0.Profile.ObservationBloodGroupSerology,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Blood_Group_Serology_Child",
        type: MR.V1_0_0.Profile.ObservationBloodGroupSerologyChild,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Blood_Pressure",
        type: MR.V1_0_0.Profile.ObservationBloodPressure,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Breastfeeding_Behavior",
        type: MR.V1_0_0.Profile.ObservationBreastfeedingBehavior,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Calculated_Delivery_Date",
        type: MR.V1_0_0.Profile.ObservationCalculatedDeliveryDate,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Cardiotocography",
        type: MR.V1_0_0.Profile.ObservationCardiotocography,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Catalogue_A",
        type: MR.V1_0_0.Profile.ObservationCatalogueA,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Child_Is_Healthy",
        type: MR.V1_0_0.Profile.ObservationChildIsHealthy,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Child_Movement",
        type: MR.V1_0_0.Profile.ObservationChildMovement,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Child_Position",
        type: MR.V1_0_0.Profile.ObservationChildPosition,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Consultation_Initiated",
        type: MR.V1_0_0.Profile.ObservationConsultationInitiated,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Date_Determination_Childbirth",
        type: MR.V1_0_0.Profile.ObservationDateDeterminationChildbirth,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Date_Of_Conception",
        type: MR.V1_0_0.Profile.ObservationDateOfConception,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Determination_Of_Pregnancy",
        type: MR.V1_0_0.Profile.ObservationDeterminationOfPregnancy,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Direct_Coombstest",
        type: MR.V1_0_0.Profile.ObservationDirectCoombstest,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Edema",
        type: MR.V1_0_0.Profile.ObservationEdema,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Examination",
        type: MR.V1_0_0.Profile.ObservationExamination,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_External_Birth",
        type: MR.V1_0_0.Profile.ObservationExternalBirth,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Findings_Required_Control",
        type: MR.V1_0_0.Profile.ObservationFindingsRequiredControl,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Fundus_Height",
        type: MR.V1_0_0.Profile.ObservationFundusHeight,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_General_Information",
        type: MR.V1_0_0.Profile.ObservationGeneralInformation,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Gravida",
        type: MR.V1_0_0.Profile.ObservationGravida,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Gynecological_Finding_Normal",
        type: MR.V1_0_0.Profile.ObservationGynecologicalFindingNormal,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Head_Circumference",
        type: MR.V1_0_0.Profile.ObservationHeadCircumference,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Heart_Action",
        type: MR.V1_0_0.Profile.ObservationHeartAction,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Heart_Sounds_Child",
        type: MR.V1_0_0.Profile.ObservationHeartSoundsChild,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Height",
        type: MR.V1_0_0.Profile.ObservationHeight,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_HIV_Test_Performed",
        type: MR.V1_0_0.Profile.ObservationHIVTestPerformed,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Immunization_Status",
        type: MR.V1_0_0.Profile.ObservationImmunizationStatus,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Inpatient_Stay_During_Pregnancy",
        type: MR.V1_0_0.Profile.ObservationInpatientStayDuringPregnancy,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Live_Birth",
        type: MR.V1_0_0.Profile.ObservationLiveBirth,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Localisation_Placenta",
        type: MR.V1_0_0.Profile.ObservationLocalisationPlacenta,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Malformation",
        type: MR.V1_0_0.Profile.ObservationMalformation,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Menstrual_Cycle",
        type: MR.V1_0_0.Profile.ObservationMenstrualCycle,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Morphology",
        type: MR.V1_0_0.Profile.ObservationMorphology,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Need_Of_Treatment_U3",
        type: MR.V1_0_0.Profile.ObservationNeedOfTreatmentU3,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Number_Of_Checkups",
        type: MR.V1_0_0.Profile.ObservationNumberOfCheckups,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_oGTT_Diagnosistest",
        type: MR.V1_0_0.Profile.ObservationoGTTDiagnosistest,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_oGTT_Pretest",
        type: MR.V1_0_0.Profile.ObservationoGTTPretest,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Other_Blood_Group_Systems",
        type: MR.V1_0_0.Profile.ObservationOtherBloodGroupSystems,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Other_Ultrasound_Studies",
        type: MR.V1_0_0.Profile.ObservationOtherUltrasoundStudies,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Para",
        type: MR.V1_0_0.Profile.ObservationPara,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Percentile",
        type: MR.V1_0_0.Profile.ObservationPercentile,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_pH_Value_Umbilical_Artery",
        type: MR.V1_0_0.Profile.ObservationpHValueUmbilicalArtery,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Pregnancy_Information",
        type: MR.V1_0_0.Profile.ObservationPregnancyInformation,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Pregnancy_Risk",
        type: MR.V1_0_0.Profile.ObservationPregnancyRisk,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Presentation_At_Birth_Clinic",
        type: MR.V1_0_0.Profile.ObservationPresentationAtBirthClinic,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Previous_Pregnancy",
        type: MR.V1_0_0.Profile.ObservationPreviousPregnancy,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Puerperium_Normal",
        type: MR.V1_0_0.Profile.ObservationPuerperiumNormal,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Singleton_Pregnancy",
        type: MR.V1_0_0.Profile.ObservationSingletonPregnancy,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Special_Findings",
        type: MR.V1_0_0.Profile.ObservationSpecialFindings,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Timely_Development",
        type: MR.V1_0_0.Profile.ObservationTimelyDevelopment,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_U3_Performed",
        type: MR.V1_0_0.Profile.ObservationU3Performed,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Ultrasound",
        type: MR.V1_0_0.Profile.ObservationUltrasound,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Urine",
        type: MR.V1_0_0.Profile.ObservationUrine,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Urine_Blood",
        type: MR.V1_0_0.Profile.ObservationUrineBlood,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Urine_Nitrite",
        type: MR.V1_0_0.Profile.ObservationUrineNitrite,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Urine_Protein",
        type: MR.V1_0_0.Profile.ObservationUrineProtein,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Urine_Sediment",
        type: MR.V1_0_0.Profile.ObservationUrineSediment,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Urine_Sugar",
        type: MR.V1_0_0.Profile.ObservationUrineSugar,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Vaginal_Examination",
        type: MR.V1_0_0.Profile.ObservationVaginalExamination,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Varicosis",
        type: MR.V1_0_0.Profile.ObservationVaricosis,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Weight_Child",
        type: MR.V1_0_0.Profile.ObservationWeightChild,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "weight-1",
                severity: "error",
                human: "When Observation.vlaue[x] is not present, Observation.dataAbsentReason SHALL be present",
                expression: "value.empty() implies dataAbsentReason.empty()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_Base_BodyWeight_Max"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Weight_Mother",
        type: MR.V1_0_0.Profile.ObservationWeightMother,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "weight-1",
                severity: "error",
                human: "When Observation.vlaue[x] is not present, Observation.dataAbsentReason SHALL be present",
                expression: "value.empty() implies dataAbsentReason.empty()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_Base_BodyWeight_Max"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Organization",
        type: MR.V1_0_0.Profile.Organization,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "org-1",
                severity: "error",
                human: "The organization SHALL at least have a name or an identifier, and possibly more than one",
                expression: "(identifier.count() + name.count()) > 0",
                xpath: "count(f:identifier | f:name) > 0",
                source: "http://hl7.org/fhir/StructureDefinition/Organization"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Patient_Child",
        type: MR.V1_0_0.Profile.PatientChild,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Patient_Mother",
        type: MR.V1_0_0.Profile.PatientMother,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pat-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de').empty()",
                source: "http://fhir.de/StructureDefinition/Patient"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Practitioner",
        type: MR.V1_0_0.Profile.Practitioner,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pract-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de/0.2').empty()",
                source: "http://fhir.de/StructureDefinition/Practitioner"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Procedure_Anti_D_Prophylaxis",
        type: MR.V1_0_0.Profile.ProcedureAntiDProphylaxis,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Procedure_Counselling",
        type: MR.V1_0_0.Profile.ProcedureCounselling,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Appointment_Pregnancy",
        type: MR.V1_1_0.Profile.AppointmentPregnancy,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "app-4",
                severity: "error",
                human: "Cancelation reason is only used for appointments that have been cancelled, or no-show",
                expression:
                    "Appointment.cancelationReason.exists() implies (Appointment.status='no-show' or Appointment.status='cancelled')",
                xpath: "not(exists(f:cancellationReason)) or f:status/@value=('no-show', 'cancelled')",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-3",
                severity: "error",
                human: "Only proposed or cancelled appointments can be missing start/end dates",
                expression:
                    "(start.exists() and end.exists()) or (status in ('proposed' | 'cancelled' | 'waitlist'))",
                xpath: "((exists(f:start) and exists(f:end)) or (f:status/@value='proposed') or (f:status/@value='cancelled') or (f:status/@value='waitlist'))",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-2",
                severity: "error",
                human: "Either start and end are specified, or neither",
                expression: "start.exists() = end.exists()",
                xpath: "((exists(f:start) and exists(f:end)) or (not(exists(f:start)) and not(exists(f:end))))",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Bundle",
        type: MR.V1_1_0.Profile.Bundle,
        version: "1.1.0",
        constraints: [
            {
                key: "bdl-7",
                severity: "error",
                human: "FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (except in history bundles)",
                expression:
                    "(type = 'history') or entry.where(fullUrl.exists()).select(fullUrl&resource.meta.versionId).isDistinct()",
                xpath: "(f:type/@value = 'history') or (count(for $entry in f:entry[f:resource] return $entry[count(parent::f:Bundle/f:entry[f:fullUrl/@value=$entry/f:fullUrl/@value and ((not(f:resource/*/f:meta/f:versionId/@value) and not($entry/f:resource/*/f:meta/f:versionId/@value)) or f:resource/*/f:meta/f:versionId/@value=$entry/f:resource/*/f:meta/f:versionId/@value)])!=1])=0)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-9",
                severity: "error",
                human: "A document must have an identifier with a system and a value",
                expression:
                    "type = 'document' implies (identifier.system.exists() and identifier.value.exists())",
                xpath: "not(f:type/@value = 'document') or exists(f:identifier/f:system) or exists(f:identifier/f:value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-3",
                severity: "error",
                human: "entry.request mandatory for batch/transaction/history, otherwise prohibited",
                expression:
                    "entry.all(request.exists() = (%resource.type = 'batch' or %resource.type = 'transaction' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:request) or (f:type/@value = 'batch') or (f:type/@value = 'transaction') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-4",
                severity: "error",
                human: "entry.response mandatory for batch-response/transaction-response/history, otherwise prohibited",
                expression:
                    "entry.all(response.exists() = (%resource.type = 'batch-response' or %resource.type = 'transaction-response' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:response) or (f:type/@value = 'batch-response') or (f:type/@value = 'transaction-response') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-12",
                severity: "error",
                human: "A message must have a MessageHeader as the first resource",
                expression:
                    "type = 'message' implies entry.first().resource.is(MessageHeader)",
                xpath: "not(f:type/@value='message') or f:entry[1]/f:resource/f:MessageHeader",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-1",
                severity: "error",
                human: "total only when a search or history",
                expression: "total.empty() or (type = 'searchset') or (type = 'history')",
                xpath: "not(f:total) or (f:type/@value = 'searchset') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-2",
                severity: "error",
                human: "entry.search only when a search",
                expression: "entry.search.empty() or (type = 'searchset')",
                xpath: "not(f:entry/f:search) or (f:type/@value = 'searchset')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-11",
                severity: "error",
                human: "A document must have a Composition as the first resource",
                expression:
                    "type = 'document' implies entry.first().resource.is(Composition)",
                xpath: "not(f:type/@value='document') or f:entry[1]/f:resource/f:Composition",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-10",
                severity: "error",
                human: "A document must have a date",
                expression: "type = 'document' implies (timestamp.hasValue())",
                xpath: "not(f:type/@value = 'document') or exists(f:timestamp/@value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "TypeComposition",
                severity: "error",
                human: "Es muss genau eine Composition enthalten sein",
                expression:
                    "entry.where(resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Composition|1.1.0').count()=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Bundle"
            },
            {
                key: "OneComposition",
                severity: "error",
                human: "Es darf genau eine Composition geben",
                expression: "entry.where(resource as Composition).count()=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Bundle"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Birth_Examination_Child_Information",
        type: MR.V1_1_0.Profile.ClinicalImpressionBirthExaminationChildInformation,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Birth_Examination_Delivery_Information",
        type: MR.V1_1_0.Profile.ClinicalImpressionBirthExaminationDeliveryInformation,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_First_Examination_After_Childbirth_Child",
        type: MR.V1_1_0.Profile.ClinicalImpressionFirstExaminationAfterChildbirthChild,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_First_Examination_After_Childbirth_Mother",
        type: MR.V1_1_0.Profile.ClinicalImpressionFirstExaminationAfterChildbirthMother,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Initial_Examination",
        type: MR.V1_1_0.Profile.ClinicalImpressionInitialExamination,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Pregnancy_Chart_Entry",
        type: MR.V1_1_0.Profile.ClinicalImpressionPregnancyChartEntry,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Pregnancy_Examination_Discharge_Summary",
        type: MR.V1_1_0.Profile.ClinicalImpressionPregnancyExaminationDischargeSummary,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_ClinicalImpression_Second_Examination_After_Childbirth",
        type: MR.V1_1_0.Profile.ClinicalImpressionSecondExaminationAfterChildbirth,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Composition",
        type: MR.V1_1_0.Profile.Composition,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_DiagnosticReport_Ultrasound_I",
        type: MR.V1_1_0.Profile.DiagnosticReportUltrasoundI,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_DiagnosticReport_Ultrasound_II",
        type: MR.V1_1_0.Profile.DiagnosticReportUltrasoundII,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_DiagnosticReport_Ultrasound_III",
        type: MR.V1_1_0.Profile.DiagnosticReportUltrasoundIII,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Encounter_Arrival_Maternity_Hospital",
        type: MR.V1_1_0.Profile.EncounterArrivalMaternityHospital,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Encounter_General",
        type: MR.V1_1_0.Profile.EncounterGeneral,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Encounter_Inpatient_Treatment",
        type: MR.V1_1_0.Profile.EncounterInpatientTreatment,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Abnormalities",
        type: MR.V1_1_0.Profile.ObservationAbnormalities,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Advice_On_Iodine_Intake",
        type: MR.V1_1_0.Profile.ObservationAdviceOnIodineIntake,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Age",
        type: MR.V1_1_0.Profile.ObservationAge,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Anti_D_Prophylaxis_Post_Partum",
        type: MR.V1_1_0.Profile.ObservationAntiDProphylaxisPostPartum,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Apgar_Score",
        type: MR.V1_1_0.Profile.ObservationApgarScore,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Baseline_Weight_Mother",
        type: MR.V1_1_0.Profile.ObservationBaselineWeightMother,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "weight-1",
                severity: "error",
                human: "When Observation.vlaue[x] is not present, Observation.dataAbsentReason SHALL be present",
                expression: "value.empty() implies dataAbsentReason.empty()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_Base_BodyWeight_Max"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Biometrics_I",
        type: MR.V1_1_0.Profile.ObservationBiometricsI,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Biometrics_II",
        type: MR.V1_1_0.Profile.ObservationBiometricsII,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Biometrics_III",
        type: MR.V1_1_0.Profile.ObservationBiometricsIII,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Birth_Height",
        type: MR.V1_1_0.Profile.ObservationBirthHeight,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Birth_Mode",
        type: MR.V1_1_0.Profile.ObservationBirthMode,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Blood_Group_Serology",
        type: MR.V1_1_0.Profile.ObservationBloodGroupSerology,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Blood_Group_Serology_Child",
        type: MR.V1_1_0.Profile.ObservationBloodGroupSerologyChild,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Blood_Group_Serology_Fetus",
        type: MR.V1_1_0.Profile.ObservationBloodGroupSerologyFetus,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Blood_Pressure",
        type: MR.V1_1_0.Profile.ObservationBloodPressure,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Breastfeeding_Behavior",
        type: MR.V1_1_0.Profile.ObservationBreastfeedingBehavior,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Calculated_Delivery_Date",
        type: MR.V1_1_0.Profile.ObservationCalculatedDeliveryDate,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Cardiotocography",
        type: MR.V1_1_0.Profile.ObservationCardiotocography,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Catalogue_A",
        type: MR.V1_1_0.Profile.ObservationCatalogueA,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Child_Is_Healthy",
        type: MR.V1_1_0.Profile.ObservationChildIsHealthy,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Child_Movement",
        type: MR.V1_1_0.Profile.ObservationChildMovement,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Child_Position",
        type: MR.V1_1_0.Profile.ObservationChildPosition,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Child_Position_At_Birth",
        type: MR.V1_1_0.Profile.ObservationChildPositionAtBirth,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Consultation_Initiated",
        type: MR.V1_1_0.Profile.ObservationConsultationInitiated,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Date_Determination_Childbirth",
        type: MR.V1_1_0.Profile.ObservationDateDeterminationChildbirth,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Date_Of_Conception",
        type: MR.V1_1_0.Profile.ObservationDateOfConception,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Delivery_Date",
        type: MR.V1_1_0.Profile.ObservationDeliveryDate,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Determination_Of_Pregnancy",
        type: MR.V1_1_0.Profile.ObservationDeterminationOfPregnancy,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Direct_Coombstest",
        type: MR.V1_1_0.Profile.ObservationDirectCoombstest,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Edema",
        type: MR.V1_1_0.Profile.ObservationEdema,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Examination",
        type: MR.V1_1_0.Profile.ObservationExamination,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Examination_Masked",
        type: MR.V1_1_0.Profile.ObservationExaminationMasked,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_External_Birth",
        type: MR.V1_1_0.Profile.ObservationExternalBirth,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Findings_Required_Control",
        type: MR.V1_1_0.Profile.ObservationFindingsRequiredControl,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Fundus_Height",
        type: MR.V1_1_0.Profile.ObservationFundusHeight,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_General_Information",
        type: MR.V1_1_0.Profile.ObservationGeneralInformation,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Gravida",
        type: MR.V1_1_0.Profile.ObservationGravida,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Gynecological_Finding_Normal",
        type: MR.V1_1_0.Profile.ObservationGynecologicalFindingNormal,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Head_Circumference",
        type: MR.V1_1_0.Profile.ObservationHeadCircumference,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Heart_Action",
        type: MR.V1_1_0.Profile.ObservationHeartAction,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Heart_Sounds_Child",
        type: MR.V1_1_0.Profile.ObservationHeartSoundsChild,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Height",
        type: MR.V1_1_0.Profile.ObservationHeight,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_HIV_Test_Performed",
        type: MR.V1_1_0.Profile.ObservationHIVTestPerformed,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Immunization_Status",
        type: MR.V1_1_0.Profile.ObservationImmunizationStatus,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Inpatient_Stay_During_Pregnancy",
        type: MR.V1_1_0.Profile.ObservationInpatientStayDuringPregnancy,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Live_Birth",
        type: MR.V1_1_0.Profile.ObservationLiveBirth,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Localisation_Placenta",
        type: MR.V1_1_0.Profile.ObservationLocalisationPlacenta,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Malformation",
        type: MR.V1_1_0.Profile.ObservationMalformation,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Menstrual_Cycle",
        type: MR.V1_1_0.Profile.ObservationMenstrualCycle,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Morphology",
        type: MR.V1_1_0.Profile.ObservationMorphology,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Need_Of_Treatment_U3",
        type: MR.V1_1_0.Profile.ObservationNeedOfTreatmentU3,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Number_Of_Checkups",
        type: MR.V1_1_0.Profile.ObservationNumberOfCheckups,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_oGTT_Diagnosistest",
        type: MR.V1_1_0.Profile.ObservationoGTTDiagnosistest,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_oGTT_Pretest",
        type: MR.V1_1_0.Profile.ObservationoGTTPretest,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Other_Blood_Group_Systems",
        type: MR.V1_1_0.Profile.ObservationOtherBloodGroupSystems,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Other_Ultrasound_Studies",
        type: MR.V1_1_0.Profile.ObservationOtherUltrasoundStudies,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Para",
        type: MR.V1_1_0.Profile.ObservationPara,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Percentile",
        type: MR.V1_1_0.Profile.ObservationPercentile,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_pH_Value_Umbilical_Artery",
        type: MR.V1_1_0.Profile.ObservationpHValueUmbilicalArtery,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Pregnancy_Information",
        type: MR.V1_1_0.Profile.ObservationPregnancyInformation,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Pregnancy_Risk",
        type: MR.V1_1_0.Profile.ObservationPregnancyRisk,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Presentation_At_Birth_Clinic",
        type: MR.V1_1_0.Profile.ObservationPresentationAtBirthClinic,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Previous_Pregnancy",
        type: MR.V1_1_0.Profile.ObservationPreviousPregnancy,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "date-1",
                severity: "error",
                human: "Der Zeitpunkt der vorangegangenen Schwangerschaften soll nur das Jahr umfassen und somit nur 4 Stellen haben",
                expression: "valueDateTime.toString().length()=4",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Previous_Pregnancy|1.1.0"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Puerperium_Normal",
        type: MR.V1_1_0.Profile.ObservationPuerperiumNormal,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Singleton_Pregnancy",
        type: MR.V1_1_0.Profile.ObservationSingletonPregnancy,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Special_Findings",
        type: MR.V1_1_0.Profile.ObservationSpecialFindings,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Timely_Development",
        type: MR.V1_1_0.Profile.ObservationTimelyDevelopment,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_U3_Performed",
        type: MR.V1_1_0.Profile.ObservationU3Performed,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Ultrasound",
        type: MR.V1_1_0.Profile.ObservationUltrasound,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Urine",
        type: MR.V1_1_0.Profile.ObservationUrine,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Urine_Protein",
        type: MR.V1_1_0.Profile.ObservationUrineProtein,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Urine_Sugar",
        type: MR.V1_1_0.Profile.ObservationUrineSugar,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Vaginal_Examination",
        type: MR.V1_1_0.Profile.ObservationVaginalExamination,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Varicosis",
        type: MR.V1_1_0.Profile.ObservationVaricosis,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Weight_Child",
        type: MR.V1_1_0.Profile.ObservationWeightChild,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "weight-1",
                severity: "error",
                human: "When Observation.vlaue[x] is not present, Observation.dataAbsentReason SHALL be present",
                expression: "value.empty() implies dataAbsentReason.empty()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_Base_BodyWeight_Max"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Observation_Weight_Mother",
        type: MR.V1_1_0.Profile.ObservationWeightMother,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "weight-1",
                severity: "error",
                human: "When Observation.vlaue[x] is not present, Observation.dataAbsentReason SHALL be present",
                expression: "value.empty() implies dataAbsentReason.empty()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_Base_BodyWeight_Max"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Organization",
        type: MR.V1_1_0.Profile.Organization,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "org-1",
                severity: "error",
                human: "The organization SHALL at least have a name or an identifier, and possibly more than one",
                expression: "(identifier.count() + name.count()) > 0",
                xpath: "count(f:identifier | f:name) > 0",
                source: "http://hl7.org/fhir/StructureDefinition/Organization"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Patient_Child",
        type: MR.V1_1_0.Profile.PatientChild,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pat-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de').empty()",
                source: "http://fhir.de/StructureDefinition/Patient"
            },
            {
                key: "pat-1",
                severity: "error",
                human: "pid has to be an UUID",
                expression: "identifier.value.startsWith('urn:uuid:')",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Patient_Child|1.1.0"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Patient_Mother",
        type: MR.V1_1_0.Profile.PatientMother,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pat-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de').empty()",
                source: "http://fhir.de/StructureDefinition/Patient"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Practitioner",
        type: MR.V1_1_0.Profile.Practitioner,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pract-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de/0.2').empty()",
                source: "http://fhir.de/StructureDefinition/Practitioner"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Procedure_Anti_D_Prophylaxis",
        type: MR.V1_1_0.Profile.ProcedureAntiDProphylaxis,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_MR_Procedure_Counselling",
        type: MR.V1_1_0.Profile.ProcedureCounselling,
        version: "1.1.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Organization_Screening_Laboratory",
        type: CMR.V1_0_1.Profile.CMROrganizationScreeningLaboratory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "org-1",
                severity: "error",
                human: "The organization SHALL at least have a name or an identifier, and possibly more than one",
                expression: "(identifier.count() + name.count()) > 0",
                xpath: "count(f:identifier | f:name) > 0",
                source: "http://hl7.org/fhir/StructureDefinition/Organization"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Appointment_Next_Appointment",
        type: CMR.V1_0_1.Profile.CMRAppointmentNextAppointment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "app-4",
                severity: "error",
                human: "Cancelation reason is only used for appointments that have been cancelled, or no-show",
                expression:
                    "Appointment.cancelationReason.exists() implies (Appointment.status='no-show' or Appointment.status='cancelled')",
                xpath: "not(exists(f:cancellationReason)) or f:status/@value=('no-show', 'cancelled')",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-3",
                severity: "error",
                human: "Only proposed or cancelled appointments can be missing start/end dates",
                expression:
                    "(start.exists() and end.exists()) or (status in ('proposed' | 'cancelled' | 'waitlist'))",
                xpath: "((exists(f:start) and exists(f:end)) or (f:status/@value='proposed') or (f:status/@value='cancelled') or (f:status/@value='waitlist'))",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-2",
                severity: "error",
                human: "Either start and end are specified, or neither",
                expression: "start.exists() = end.exists()",
                xpath: "((exists(f:start) and exists(f:end)) or (not(exists(f:start)) and not(exists(f:end))))",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-1",
                severity: "error",
                human: "At least year and month are needed",
                expression: "requestedPeriod.start.toString().length() >= 7",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Appointment_Next_Appointment"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Appointment_Next_Immunization_Appointment",
        type: CMR.V1_0_1.Profile.CMRAppointmentNextImmunizationAppointment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "app-4",
                severity: "error",
                human: "Cancelation reason is only used for appointments that have been cancelled, or no-show",
                expression:
                    "Appointment.cancelationReason.exists() implies (Appointment.status='no-show' or Appointment.status='cancelled')",
                xpath: "not(exists(f:cancellationReason)) or f:status/@value=('no-show', 'cancelled')",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-3",
                severity: "error",
                human: "Only proposed or cancelled appointments can be missing start/end dates",
                expression:
                    "(start.exists() and end.exists()) or (status in ('proposed' | 'cancelled' | 'waitlist'))",
                xpath: "((exists(f:start) and exists(f:end)) or (f:status/@value='proposed') or (f:status/@value='cancelled') or (f:status/@value='waitlist'))",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-2",
                severity: "error",
                human: "Either start and end are specified, or neither",
                expression: "start.exists() = end.exists()",
                xpath: "((exists(f:start) and exists(f:end)) or (not(exists(f:start)) and not(exists(f:end))))",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-1",
                severity: "error",
                human: "At least year and month are needed",
                expression: "requestedPeriod.start.toString().length() >= 7",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Appointment_Next_Immunization_Appointment"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Appointment_Participation_Period",
        type: CMR.V1_0_1.Profile.CMRAppointmentParticipationPeriod,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "app-4",
                severity: "error",
                human: "Cancelation reason is only used for appointments that have been cancelled, or no-show",
                expression:
                    "Appointment.cancelationReason.exists() implies (Appointment.status='no-show' or Appointment.status='cancelled')",
                xpath: "not(exists(f:cancellationReason)) or f:status/@value=('no-show', 'cancelled')",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-3",
                severity: "error",
                human: "Only proposed or cancelled appointments can be missing start/end dates",
                expression:
                    "(start.exists() and end.exists()) or (status in ('proposed' | 'cancelled' | 'waitlist'))",
                xpath: "((exists(f:start) and exists(f:end)) or (f:status/@value='proposed') or (f:status/@value='cancelled') or (f:status/@value='waitlist'))",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            },
            {
                key: "app-2",
                severity: "error",
                human: "Either start and end are specified, or neither",
                expression: "start.exists() = end.exists()",
                xpath: "((exists(f:start) and exists(f:end)) or (not(exists(f:start)) and not(exists(f:end))))",
                source: "http://hl7.org/fhir/StructureDefinition/Appointment"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Bundle",
        type: CMR.V1_0_1.Profile.CMRBundle,
        version: "1.0.1",
        constraints: [
            {
                key: "bdl-7",
                severity: "error",
                human: "FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (except in history bundles)",
                expression:
                    "(type = 'history') or entry.where(fullUrl.exists()).select(fullUrl&resource.meta.versionId).isDistinct()",
                xpath: "(f:type/@value = 'history') or (count(for $entry in f:entry[f:resource] return $entry[count(parent::f:Bundle/f:entry[f:fullUrl/@value=$entry/f:fullUrl/@value and ((not(f:resource/*/f:meta/f:versionId/@value) and not($entry/f:resource/*/f:meta/f:versionId/@value)) or f:resource/*/f:meta/f:versionId/@value=$entry/f:resource/*/f:meta/f:versionId/@value)])!=1])=0)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-9",
                severity: "error",
                human: "A document must have an identifier with a system and a value",
                expression:
                    "type = 'document' implies (identifier.system.exists() and identifier.value.exists())",
                xpath: "not(f:type/@value = 'document') or exists(f:identifier/f:system) or exists(f:identifier/f:value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-3",
                severity: "error",
                human: "entry.request mandatory for batch/transaction/history, otherwise prohibited",
                expression:
                    "entry.all(request.exists() = (%resource.type = 'batch' or %resource.type = 'transaction' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:request) or (f:type/@value = 'batch') or (f:type/@value = 'transaction') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-4",
                severity: "error",
                human: "entry.response mandatory for batch-response/transaction-response/history, otherwise prohibited",
                expression:
                    "entry.all(response.exists() = (%resource.type = 'batch-response' or %resource.type = 'transaction-response' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:response) or (f:type/@value = 'batch-response') or (f:type/@value = 'transaction-response') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-12",
                severity: "error",
                human: "A message must have a MessageHeader as the first resource",
                expression:
                    "type = 'message' implies entry.first().resource.is(MessageHeader)",
                xpath: "not(f:type/@value='message') or f:entry[1]/f:resource/f:MessageHeader",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-1",
                severity: "error",
                human: "total only when a search or history",
                expression: "total.empty() or (type = 'searchset') or (type = 'history')",
                xpath: "not(f:total) or (f:type/@value = 'searchset') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-2",
                severity: "error",
                human: "entry.search only when a search",
                expression: "entry.search.empty() or (type = 'searchset')",
                xpath: "not(f:entry/f:search) or (f:type/@value = 'searchset')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-11",
                severity: "error",
                human: "A document must have a Composition as the first resource",
                expression:
                    "type = 'document' implies entry.first().resource.is(Composition)",
                xpath: "not(f:type/@value='document') or f:entry[1]/f:resource/f:Composition",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-10",
                severity: "error",
                human: "A document must have a date",
                expression: "type = 'document' implies (timestamp.hasValue())",
                xpath: "not(f:type/@value = 'document') or exists(f:timestamp/@value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "TypeComposition",
                severity: "error",
                human: "Es d√ºrfen nur Compositions der U-Untersuchungen bzw. der speziellen Fr√ºherkennungsuntersuchungen vorhanden sein",
                expression:
                    "entry.where(meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U1' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U2' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U3' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U4' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U5' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U6' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U7' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U8' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U9' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Cystic_Fibrosis_Screening' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Extended_Newborn_Screening' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Hip_Screening' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Neonatal_Hearscreening' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Percentile_Curve' or meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Pulse_Oxymetry_Screening').isDistinct()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Bundle"
            },
            {
                key: "OneComposition",
                severity: "error",
                human: "Es darf genau eine Composition geben",
                expression: "entry.where(ofType(Composition)).isDistinct()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Bundle"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Care_Plan_U2_U9_Result",
        type: CMR.V1_0_1.Profile.CMRCarePlanU2U9Result,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Care_Plan_U3_U4_Hip_Screening_Plan",
        type: CMR.V1_0_1.Profile.CMRCarePlanU3U4HipScreeningPlan,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Cystic_Fibrosis_Screening",
        type: CMR.V1_0_1.Profile.CMRCompositionCysticFibrosisScreening,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Extended_Newborn_Screening",
        type: CMR.V1_0_1.Profile.CMRCompositionExtendedNewbornScreening,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Hip_Screening",
        type: CMR.V1_0_1.Profile.CMRCompositionHipScreening,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Neonatal_Hearscreening",
        type: CMR.V1_0_1.Profile.CMRCompositionNeonatalHearscreening,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Percentile_Curve",
        type: CMR.V1_0_1.Profile.CMRCompositionPercentileCurve,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_Pulse_Oxymetry_Screening",
        type: CMR.V1_0_1.Profile.CMRCompositionPulseOxymetryScreening,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U1",
        type: CMR.V1_0_1.Profile.CMRCompositionU1,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U2",
        type: CMR.V1_0_1.Profile.CMRCompositionU2,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U3",
        type: CMR.V1_0_1.Profile.CMRCompositionU3,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U4",
        type: CMR.V1_0_1.Profile.CMRCompositionU4,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U5",
        type: CMR.V1_0_1.Profile.CMRCompositionU5,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U6",
        type: CMR.V1_0_1.Profile.CMRCompositionU6,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U7",
        type: CMR.V1_0_1.Profile.CMRCompositionU7,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U7a",
        type: CMR.V1_0_1.Profile.CMRCompositionU7a,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U8",
        type: CMR.V1_0_1.Profile.CMRCompositionU8,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Composition_U9",
        type: CMR.V1_0_1.Profile.CMRCompositionU9,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_Percentile_Body_Measures",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportPercentileBodyMeasures,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_Percentile_Values",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportPercentileValues,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U1_Apgar_Score",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU1ApgarScore,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U1_Birth_Length",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU1BirthLength,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U1_Birth_Trauma_Of_Fetus",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU1BirthTraumaOfFetus,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U1_Birth_Weight",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU1BirthWeight,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U1_Congenital_Malformation",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU1CongenitalMalformation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U1_Edema_Of_Newborn",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU1EdemaOfNewborn,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U1_Neonatal_Jaundice",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU1NeonatalJaundice,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U1_Term_Infant",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU1TermInfant,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U1_U3_Pulse_Oxymetry",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU1U3PulseOxymetry,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U1_U5_Neonatal_Hearscreening",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU1U5NeonatalHearscreening,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U1_U5_Pediatric_Diagnostic_Audiology_Service",
        type: CMR.V1_0_1.Profile
            .CMRDiagnosticReportU1U5PediatricDiagnosticAudiologyService,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U2_Physical_Exam_Head",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU2PhysicalExamHead,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U2_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU2PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U2_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU2PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U2_Physical_Exam_Skin",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU2PhysicalExamSkin,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U2_U3_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU2U3PhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U2_U3_Physical_Exam_Ears",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU2U3PhysicalExamEars,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U2_U3_Physical_Exam_Eyes",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU2U3PhysicalExamEyes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U2_U4_Physical_Exam_Chest_Lung_Respiratory_Tract",
        type: CMR.V1_0_1.Profile
            .CMRDiagnosticReportU2U4PhysicalExamChestLungRespiratoryTract,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U2_U6_Body_Measures",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU2U6BodyMeasures,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U2_U6_Physical_Exam_Heart_Blood_Circulation",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU2U6PhysicalExamHeartBloodCirculation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U3_Physical_Exam_Head",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU3PhysicalExamHead,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U3_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU3PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U3_U4_Hip_Screening",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU3U4HipScreening,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U3_U4_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU3U4PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U3_U4_Physical_Exam_Skin",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU3U4PhysicalExamSkin,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U4_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU4PhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U4_Physical_Exam_Head",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU4PhysicalExamHead,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U4_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU4PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U4_U5_Physical_Exam_Eyes",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU4U5PhysicalExamEyes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U5_Physical_Exam_Chest_Lung_Respiratory_Tract",
        type: CMR.V1_0_1.Profile
            .CMRDiagnosticReportU5PhysicalExamChestLungRespiratoryTract,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U5_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU5PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U5_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU5PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U5_U6_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU5U6PhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U5_U6_Physical_Exam_Head",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU5U6PhysicalExamHead,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U5_U9_Physical_Exam_Skin",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU5U9PhysicalExamSkin,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U6_Physical_Exam_Eyes",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU6PhysicalExamEyes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U6_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU6PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U6_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU6PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U6_U7_Physical_Exam_Chest_Lung_Respiratory_Tract",
        type: CMR.V1_0_1.Profile
            .CMRDiagnosticReportU6U7PhysicalExamChestLungRespiratoryTract,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U7a_and_U9_Physical_Exam_Chest_Lung_Respiratory_Tract",
        type: CMR.V1_0_1.Profile
            .CMRDiagnosticReportU7aandU9PhysicalExamChestLungRespiratoryTract,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U7a_and_U9_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile
            .CMRDiagnosticReportU7aandU9PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U7a_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU7aPhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U7a_U9_Physical_Exam_Eyes",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU7aU9PhysicalExamEyes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U7_Physical_Exam_Eyes",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU7PhysicalExamEyes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U7_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU7PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U7_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU7PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U7_U7a_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU7U7aPhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U7_U9_Body_Measures",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU7U9BodyMeasures,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U7_U9_Physical_Exam_Heart_Blood_Circulation",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU7U9PhysicalExamHeartBloodCirculation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U8_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU8PhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U8_Physical_Exam_Chest_Lung_Respiratory_Tract",
        type: CMR.V1_0_1.Profile
            .CMRDiagnosticReportU8PhysicalExamChestLungRespiratoryTract,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U8_Physical_Exam_Ears",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU8PhysicalExamEars,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U8_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU8PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U8_U9_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU8U9PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Diagnostic_Report_U9_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRDiagnosticReportU9PhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Encounter",
        type: CMR.V1_0_1.Profile.CMREncounter,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Medication_Statement_Vitamine_K_Prophylaxis",
        type: CMR.V1_0_1.Profile.CMRMedicationStatementVitamineKProphylaxis,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "med-1",
                severity: "error",
                human: "Either free text or doseQuantity and route must exist",
                expression:
                    "dosage.text.empty().not() xor (dosage.route.empty().not() and dosage.doseAndRate.dose.empty().not())",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Medication_Statement_Vitamine_K_Prophylaxis"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_Comments",
        type: CMR.V1_0_1.Profile.CMRObservationComments,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_Head_Circumference",
        type: CMR.V1_0_1.Profile.CMRObservationHeadCircumference,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_Percentile_Values",
        type: CMR.V1_0_1.Profile.CMRObservationPercentileValues,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-1",
                severity: "error",
                human: "At least year, month and day are needed",
                expression: "effective.toString().length() >= 10",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_Percentile_Values"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_Physical_Exam_Parental_Assessment",
        type: CMR.V1_0_1.Profile.CMRObservationPhysicalExamParentalAssessment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_Apgar_Score",
        type: CMR.V1_0_1.Profile.CMRObservationU1ApgarScore,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_Birth_Length",
        type: CMR.V1_0_1.Profile.CMRObservationU1BirthLength,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_Birth_Trauma_Of_Fetus",
        type: CMR.V1_0_1.Profile.CMRObservationU1BirthTraumaOfFetus,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_Birth_Weight",
        type: CMR.V1_0_1.Profile.CMRObservationU1BirthWeight,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "weight-1",
                severity: "error",
                human: "When Observation.vlaue[x] is not present, Observation.dataAbsentReason SHALL be present",
                expression: "value.empty() implies dataAbsentReason.empty()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_Base_BodyWeight_Max"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_Congenital_Malformation",
        type: CMR.V1_0_1.Profile.CMRObservationU1CongenitalMalformation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_Edema_Of_Newborn",
        type: CMR.V1_0_1.Profile.CMRObservationU1EdemaOfNewborn,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_Family_History",
        type: CMR.V1_0_1.Profile.CMRObservationU1FamilyHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_Neonatal_Jaundice",
        type: CMR.V1_0_1.Profile.CMRObservationU1NeonatalJaundice,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_Term_Infant",
        type: CMR.V1_0_1.Profile.CMRObservationU1TermInfant,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Base_Excess",
        type: CMR.V1_0_1.Profile.CMRObservationU1U3BaseExcess,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Birthmode",
        type: CMR.V1_0_1.Profile.CMRObservationU1U3Birthmode,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Date_Time_of_Birth",
        type: CMR.V1_0_1.Profile.CMRObservationU1U3DateTimeofBirth,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "date-1",
                severity: "error",
                human: "Der Geburtszeitpunkt muss mindestens 16 Stellen haben",
                expression: "valueDateTime.toString().length()>=16",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Date_Time_of_Birth|1.0.1"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Different_Foetal_Position",
        type: CMR.V1_0_1.Profile.CMRObservationU1U3DifferentFoetalPosition,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Foetal_Position",
        type: CMR.V1_0_1.Profile.CMRObservationU1U3FoetalPosition,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Gender_Birth_History",
        type: CMR.V1_0_1.Profile.CMRObservationU1U3GenderBirthHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Length_Gestation_At_Birth",
        type: CMR.V1_0_1.Profile.CMRObservationU1U3LengthGestationAtBirth,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_pH_Value",
        type: CMR.V1_0_1.Profile.CMRObservationU1U3pHValue,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Pregnancy_History",
        type: CMR.V1_0_1.Profile.CMRObservationU1U3PregnancyHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Prenatal_Finding",
        type: CMR.V1_0_1.Profile.CMRObservationU1U3PrenatalFinding,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Pulse_Oxymetry_Measurement",
        type: CMR.V1_0_1.Profile.CMRObservationU1U3PulseOxymetryMeasurement,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "int-1",
                severity: "error",
                human: "If the code implies, that this Observation covers a control pulse oxymetry measurement, then the interpretation code 'kontrollbed√ºrftig' SHALL not be used",
                expression:
                    "Observation.code.coding.code='250554003:363703001=262134003' implies Observation.interpretation.coding.code != '129125009:{363589002=250554003,408730004=385643006,408732007=410604004}'",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Pulse_Oxymetry_Measurement|1.0.1"
            },
            {
                key: "obs-1",
                severity: "error",
                human: "If status is cancelled, then dataAbsentReason Shall exist",
                expression:
                    "Observation.status ='cancelled' implies Observation.dataAbsentReason.exists()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U3_Pulse_Oxymetry_Measurement|1.0.1"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U5_Counseling_About_Hearscreening",
        type: CMR.V1_0_1.Profile.CMRObservationU1U5CounselingAboutHearscreening,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U5_Neonatal_Hearscreening",
        type: CMR.V1_0_1.Profile.CMRObservationU1U5NeonatalHearscreening,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-1",
                severity: "error",
                human: "At least year, month and day are needed",
                expression: "effective.toString().length() >= 10",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U5_Neonatal_Hearscreening"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U1_U5_Pediatric_Diagnostic_Audiology_Service",
        type: CMR.V1_0_1.Profile.CMRObservationU1U5PediatricDiagnosticAudiologyService,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_Current_Child_History",
        type: CMR.V1_0_1.Profile.CMRObservationU2CurrentChildHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_Family_History",
        type: CMR.V1_0_1.Profile.CMRObservationU2FamilyHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_Physical_Exam_Head",
        type: CMR.V1_0_1.Profile.CMRObservationU2PhysicalExamHead,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRObservationU2PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRObservationU2PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_Physical_Exam_Skin",
        type: CMR.V1_0_1.Profile.CMRObservationU2PhysicalExamSkin,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_Social_History",
        type: CMR.V1_0_1.Profile.CMRObservationU2SocialHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_U3_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRObservationU2U3PhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_U3_Physical_Exam_Ears",
        type: CMR.V1_0_1.Profile.CMRObservationU2U3PhysicalExamEars,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_U3_Physical_Exam_Eyes",
        type: CMR.V1_0_1.Profile.CMRObservationU2U3PhysicalExamEyes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_U4_Physical_Exam_Chest_Lung_Respiratory_Tract",
        type: CMR.V1_0_1.Profile.CMRObservationU2U4PhysicalExamChestLungRespiratoryTract,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_U6_Body_Weight",
        type: CMR.V1_0_1.Profile.CMRObservationU2U6BodyWeight,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "weight-1",
                severity: "error",
                human: "When Observation.vlaue[x] is not present, Observation.dataAbsentReason SHALL be present",
                expression: "value.empty() implies dataAbsentReason.empty()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_Base_BodyWeight_Max"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_U6_Physical_Exam_Heart_Blood_Circulation",
        type: CMR.V1_0_1.Profile.CMRObservationU2U6PhysicalExamHeartBloodCirculation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_U9_Body_Height_Measure",
        type: CMR.V1_0_1.Profile.CMRObservationU2U9BodyHeightMeasure,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_U9_No_Abnormality_Detected",
        type: CMR.V1_0_1.Profile.CMRObservationU2U9NoAbnormalityDetected,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U2_U9_Relevant_History_Results",
        type: CMR.V1_0_1.Profile.CMRObservationU2U9RelevantHistoryResults,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_Current_Child_History",
        type: CMR.V1_0_1.Profile.CMRObservationU3CurrentChildHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_Development_Assessment",
        type: CMR.V1_0_1.Profile.CMRObservationU3DevelopmentAssessment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_Family_History",
        type: CMR.V1_0_1.Profile.CMRObservationU3FamilyHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_Physical_Exam_Head",
        type: CMR.V1_0_1.Profile.CMRObservationU3PhysicalExamHead,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRObservationU3PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_U4_Hip_Screening_History",
        type: CMR.V1_0_1.Profile.CMRObservationU3U4HipScreeningHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_U4_Hip_Screening_Result",
        type: CMR.V1_0_1.Profile.CMRObservationU3U4HipScreeningResult,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-1",
                severity: "error",
                human: "For previous findings a string is needed. For finding value set is needed",
                expression:
                    "((code.coding.code = '129125009:{363589002=241503003,408730004=398166005,408731000=410588008}' or code.coding.code = '129125009:{363589002=241503003,408730004=385660001,408731000=410588008}' or code.coding.code = '129125009:{363589002=241503003,408730004=410537005,408731000=410588008}') and value is string) xor (code.coding.code = '129125009:{363589002=241503003,408730004=398166005,408731000=410584005}' and value is CodeableConcept)",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_U4_Hip_Screening_Result"
            },
            {
                key: "obs-2",
                severity: "error",
                human: "At least year, month and day are needed",
                expression: "effective.toString().length() >= 10",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_U4_Hip_Screening_Result"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_U4_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRObservationU3U4PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_U4_Physical_Exam_Skin",
        type: CMR.V1_0_1.Profile.CMRObservationU3U4PhysicalExamSkin,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_U4_Problem_Of_Hip",
        type: CMR.V1_0_1.Profile.CMRObservationU3U4ProblemOfHip,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_U6_Indication_for_Abnormality",
        type: CMR.V1_0_1.Profile.CMRObservationU3U6IndicationforAbnormality,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_U9_Age_Appropriate_Development",
        type: CMR.V1_0_1.Profile.CMRObservationU3U9AgeAppropriateDevelopment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U3_U9_Social_History",
        type: CMR.V1_0_1.Profile.CMRObservationU3U9SocialHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U4_Current_Child_History",
        type: CMR.V1_0_1.Profile.CMRObservationU4CurrentChildHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U4_Development_Assessment",
        type: CMR.V1_0_1.Profile.CMRObservationU4DevelopmentAssessment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U4_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRObservationU4PhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U4_Physical_Exam_Head",
        type: CMR.V1_0_1.Profile.CMRObservationU4PhysicalExamHead,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U4_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRObservationU4PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U4_U5_Physical_Exam_Eyes",
        type: CMR.V1_0_1.Profile.CMRObservationU4U5PhysicalExamEyes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U4_U9_Status_Of_Immunization",
        type: CMR.V1_0_1.Profile.CMRObservationU4U9StatusOfImmunization,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U5_Current_Child_History",
        type: CMR.V1_0_1.Profile.CMRObservationU5CurrentChildHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U5_Development_Assessment",
        type: CMR.V1_0_1.Profile.CMRObservationU5DevelopmentAssessment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U5_Physical_Exam_Chest_Lung_Respiratory_Tract",
        type: CMR.V1_0_1.Profile.CMRObservationU5PhysicalExamChestLungRespiratoryTract,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U5_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRObservationU5PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U5_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRObservationU5PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U5_U6_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRObservationU5U6PhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U5_U6_Physical_Exam_Head",
        type: CMR.V1_0_1.Profile.CMRObservationU5U6PhysicalExamHead,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U5_U9_Physical_Exam_Skin",
        type: CMR.V1_0_1.Profile.CMRObservationU5U9PhysicalExamSkin,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U6_Current_Child_History",
        type: CMR.V1_0_1.Profile.CMRObservationU6CurrentChildHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U6_Development_Assessment",
        type: CMR.V1_0_1.Profile.CMRObservationU6DevelopmentAssessment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U6_Physical_Exam_Eyes",
        type: CMR.V1_0_1.Profile.CMRObservationU6PhysicalExamEyes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U6_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRObservationU6PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U6_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRObservationU6PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U6_U7_Physical_Exam_Chest_Lung_Respiratory_Tract",
        type: CMR.V1_0_1.Profile.CMRObservationU6U7PhysicalExamChestLungRespiratoryTract,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7a_and_U9_Physical_Exam_Chest_Lung_Respiratory_Tract",
        type: CMR.V1_0_1.Profile
            .CMRObservationU7aandU9PhysicalExamChestLungRespiratoryTract,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7a_and_U9_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRObservationU7aandU9PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7a_Current_Child_History",
        type: CMR.V1_0_1.Profile.CMRObservationU7aCurrentChildHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7a_Development_Assessment",
        type: CMR.V1_0_1.Profile.CMRObservationU7aDevelopmentAssessment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7a_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRObservationU7aPhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7a_U9_Physical_Exam_Eyes",
        type: CMR.V1_0_1.Profile.CMRObservationU7aU9PhysicalExamEyes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7_Current_Child_History",
        type: CMR.V1_0_1.Profile.CMRObservationU7CurrentChildHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7_Development_Assessment",
        type: CMR.V1_0_1.Profile.CMRObservationU7DevelopmentAssessment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7_Physical_Exam_Eyes",
        type: CMR.V1_0_1.Profile.CMRObservationU7PhysicalExamEyes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRObservationU7PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRObservationU7PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7_U7a_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRObservationU7U7aPhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7_U9_BMI",
        type: CMR.V1_0_1.Profile.CMRObservationU7U9BMI,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7_U9_Body_Weight",
        type: CMR.V1_0_1.Profile.CMRObservationU7U9BodyWeight,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "weight-1",
                severity: "error",
                human: "When Observation.vlaue[x] is not present, Observation.dataAbsentReason SHALL be present",
                expression: "value.empty() implies dataAbsentReason.empty()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_Base_BodyWeight_Max"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U7_U9_Physical_Exam_Heart_Blood_Circulation",
        type: CMR.V1_0_1.Profile.CMRObservationU7U9PhysicalExamHeartBloodCirculation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U8_Current_Child_History",
        type: CMR.V1_0_1.Profile.CMRObservationU8CurrentChildHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U8_Development_Assessment",
        type: CMR.V1_0_1.Profile.CMRObservationU8DevelopmentAssessment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U8_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRObservationU8PhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U8_Physical_Exam_Chest_Lung_Respiratory_Tract",
        type: CMR.V1_0_1.Profile.CMRObservationU8PhysicalExamChestLungRespiratoryTract,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U8_Physical_Exam_Ears",
        type: CMR.V1_0_1.Profile.CMRObservationU8PhysicalExamEars,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U8_Physical_Exam_Musculoskeletal_System",
        type: CMR.V1_0_1.Profile.CMRObservationU8PhysicalExamMusculoskeletalSystem,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U8_U9_Physical_Exam_Mouth_Nose",
        type: CMR.V1_0_1.Profile.CMRObservationU8U9PhysicalExamMouthNose,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U9_Current_Child_History",
        type: CMR.V1_0_1.Profile.CMRObservationU9CurrentChildHistory,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U9_Development_Assessment",
        type: CMR.V1_0_1.Profile.CMRObservationU9DevelopmentAssessment,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Observation_U9_Physical_Exam_Abdomen_Genitals",
        type: CMR.V1_0_1.Profile.CMRObservationU9PhysicalExamAbdomenGenitals,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Organization",
        type: CMR.V1_0_1.Profile.CMROrganization,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "org-1",
                severity: "error",
                human: "The organization SHALL at least have a name or an identifier, and possibly more than one",
                expression: "(identifier.count() + name.count()) > 0",
                xpath: "count(f:identifier | f:name) > 0",
                source: "http://hl7.org/fhir/StructureDefinition/Organization"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Patient",
        type: CMR.V1_0_1.Profile.CMRPatient,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pat-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de').empty()",
                source: "http://fhir.de/StructureDefinition/Patient"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Practitioner",
        type: CMR.V1_0_1.Profile.CMRPractitioner,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pract-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de/0.2').empty()",
                source: "http://fhir.de/StructureDefinition/Practitioner"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_Consultation_Annotation",
        type: CMR.V1_0_1.Profile.CMRProcedureConsultationAnnotation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Cystic_Fibrosis_Screening",
        type: CMR.V1_0_1.Profile.CMRProcedureU1U3CysticFibrosisScreening,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "proc-0",
                severity: "error",
                human: "Year, month, day, hour, minute and second are needed",
                expression:
                    "performed.exists() implies performed.toString().length() >=16",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Cystic_Fibrosis_Screening"
            },
            {
                key: "proc-1",
                severity: "error",
                human: "If partOf is given,  must be completed",
                expression:
                    "partOf.exists() implies (status = 'completed' and performed.exists().not())",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Cystic_Fibrosis_Screening"
            },
            {
                key: "proc-2",
                severity: "error",
                human: "If status is not-done, partOf must be empty",
                expression: "status = 'not-done' implies partOf.exists().not()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Cystic_Fibrosis_Screening"
            },
            {
                key: "proc-3",
                severity: "error",
                human: "If statusReason is given, partOf must be empty",
                expression: "statusReason.exists() implies partOf.exists().not()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Cystic_Fibrosis_Screening"
            },
            {
                key: "proc-4",
                severity: "error",
                human: "If status is not-done, statusReason must exist",
                expression: "status ='not-done' implies statusReason.exists()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Cystic_Fibrosis_Screening"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Newborn_Blood_Spot_Screening",
        type: CMR.V1_0_1.Profile.CMRProcedureU1U3NewbornBloodSpotScreening,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "proc-0",
                severity: "error",
                human: "statusReason SHALL only be present, if performed[x] is empty",
                expression: "statusReason.empty() or performed.empty()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Newborn_Blood_Spot_Screening|1.0.1"
            },
            {
                key: "proc-1",
                severity: "error",
                human: "Extension may be choosen if first blood sampling is choosen",
                expression:
                    "extension.where(url = 'https://fhir.kbv.de/StructureDefinition/KBV_Ex_MIO_CMR_Early_Collection_Of_Blood').exists() implies (code.coding.code ='425758004:246513007=261422002')",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Newborn_Blood_Spot_Screening"
            },
            {
                key: "proc-2",
                severity: "error",
                human: "Year, month, day, hour, minute and second are needed for first sampling",
                expression:
                    "code.coding.code = '425758004:246513007=261426002' implies performed.toString().length() >= 22",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Newborn_Blood_Spot_Screening"
            },
            {
                key: "proc-3",
                severity: "error",
                human: "Year, month and day are needed for second sampling",
                expression:
                    "(code.coding.code = '425758004:246513007=261426004'  or code.coding.code = '425758004:246513007=261429006') implies performed.toString().length() = 10",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Newborn_Blood_Spot_Screening"
            },
            {
                key: "proc-4",
                severity: "error",
                human: "If status is not-done, statusReason must exist",
                expression: "status ='not-done' implies statusReason.exists()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U1_U3_Newborn_Blood_Spot_Screening"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U2_Consultation",
        type: CMR.V1_0_1.Profile.CMRProcedureU2Consultation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U3_Consultation",
        type: CMR.V1_0_1.Profile.CMRProcedureU3Consultation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U4_Consultation",
        type: CMR.V1_0_1.Profile.CMRProcedureU4Consultation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U5_Consultation",
        type: CMR.V1_0_1.Profile.CMRProcedureU5Consultation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U6_Consultation",
        type: CMR.V1_0_1.Profile.CMRProcedureU6Consultation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U7a_Consultation",
        type: CMR.V1_0_1.Profile.CMRProcedureU7aConsultation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U7_Consultation",
        type: CMR.V1_0_1.Profile.CMRProcedureU7Consultation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U8_Consultation",
        type: CMR.V1_0_1.Profile.CMRProcedureU8Consultation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Procedure_U9_Consultation",
        type: CMR.V1_0_1.Profile.CMRProcedureU9Consultation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Service_Request_Dental_Referral",
        type: CMR.V1_0_1.Profile.CMRServiceRequestDentalReferral,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "prr-1",
                severity: "error",
                human: "orderDetail SHALL only be present if code is present",
                expression: "orderDetail.empty() or code.exists()",
                xpath: "exists(f:code) or not(exists(f:orderDetail))",
                source: "http://hl7.org/fhir/StructureDefinition/ServiceRequest"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Service_Request_U1_U3_Pulse_Oxymetry_Clarification",
        type: CMR.V1_0_1.Profile.CMRServiceRequestU1U3PulseOxymetryClarification,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "prr-1",
                severity: "error",
                human: "orderDetail SHALL only be present if code is present",
                expression: "orderDetail.empty() or code.exists()",
                xpath: "exists(f:code) or not(exists(f:orderDetail))",
                source: "http://hl7.org/fhir/StructureDefinition/ServiceRequest"
            },
            {
                key: "serv-1",
                severity: "error",
                human: "At least year, month and day are needed",
                expression: "authoredOn.toString().length() >= 10",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Service_Request_U1_U3_Pulse_Oxymetry_Clarification"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Service_Request_U1_U5_Referral_Pediatric_Audiology_Service",
        type: CMR.V1_0_1.Profile.CMRServiceRequestU1U5ReferralPediatricAudiologyService,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "prr-1",
                severity: "error",
                human: "orderDetail SHALL only be present if code is present",
                expression: "orderDetail.empty() or code.exists()",
                xpath: "exists(f:code) or not(exists(f:orderDetail))",
                source: "http://hl7.org/fhir/StructureDefinition/ServiceRequest"
            },
            {
                key: "serv-0",
                severity: "error",
                human: "At least year, month and day are needed",
                expression: "authoredOn.toString().length() >= 10",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_CMR_Service_Request_U1_U5_Referral_Pediatric_Audiology_Service"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PC_Bundle",
        type: PC.V1_0_1.Profile.PCBundle,
        version: "1.0.1",
        constraints: [
            {
                key: "bdl-7",
                severity: "error",
                human: "FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (except in history bundles)",
                expression:
                    "(type = 'history') or entry.where(fullUrl.exists()).select(fullUrl&resource.meta.versionId).isDistinct()",
                xpath: "(f:type/@value = 'history') or (count(for $entry in f:entry[f:resource] return $entry[count(parent::f:Bundle/f:entry[f:fullUrl/@value=$entry/f:fullUrl/@value and ((not(f:resource/*/f:meta/f:versionId/@value) and not($entry/f:resource/*/f:meta/f:versionId/@value)) or f:resource/*/f:meta/f:versionId/@value=$entry/f:resource/*/f:meta/f:versionId/@value)])!=1])=0)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-9",
                severity: "error",
                human: "A document must have an identifier with a system and a value",
                expression:
                    "type = 'document' implies (identifier.system.exists() and identifier.value.exists())",
                xpath: "not(f:type/@value = 'document') or exists(f:identifier/f:system) or exists(f:identifier/f:value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-3",
                severity: "error",
                human: "entry.request mandatory for batch/transaction/history, otherwise prohibited",
                expression:
                    "entry.all(request.exists() = (%resource.type = 'batch' or %resource.type = 'transaction' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:request) or (f:type/@value = 'batch') or (f:type/@value = 'transaction') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-4",
                severity: "error",
                human: "entry.response mandatory for batch-response/transaction-response/history, otherwise prohibited",
                expression:
                    "entry.all(response.exists() = (%resource.type = 'batch-response' or %resource.type = 'transaction-response' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:response) or (f:type/@value = 'batch-response') or (f:type/@value = 'transaction-response') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-12",
                severity: "error",
                human: "A message must have a MessageHeader as the first resource",
                expression:
                    "type = 'message' implies entry.first().resource.is(MessageHeader)",
                xpath: "not(f:type/@value='message') or f:entry[1]/f:resource/f:MessageHeader",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-1",
                severity: "error",
                human: "total only when a search or history",
                expression: "total.empty() or (type = 'searchset') or (type = 'history')",
                xpath: "not(f:total) or (f:type/@value = 'searchset') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-2",
                severity: "error",
                human: "entry.search only when a search",
                expression: "entry.search.empty() or (type = 'searchset')",
                xpath: "not(f:entry/f:search) or (f:type/@value = 'searchset')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-11",
                severity: "error",
                human: "A document must have a Composition as the first resource",
                expression:
                    "type = 'document' implies entry.first().resource.is(Composition)",
                xpath: "not(f:type/@value='document') or f:entry[1]/f:resource/f:Composition",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-10",
                severity: "error",
                human: "A document must have a date",
                expression: "type = 'document' implies (timestamp.hasValue())",
                xpath: "not(f:type/@value = 'document') or exists(f:timestamp/@value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "TypeComposition",
                severity: "error",
                human: "vorhanden sein",
                expression:
                    "entry.where(meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PC_Composition_Examination_Participation').isDistinct()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PC_Bundle|1.0.1"
            },
            {
                key: "OneComposition",
                severity: "error",
                human: "Es darf genau eine Composition geben",
                expression: "entry.where(ofType(Composition)).isDistinct()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PC_Bundle|1.0.1"
            },
            {
                key: "UUID",
                severity: "error",
                human: "Es soll eine UUID verwendet werden.",
                expression: "identifer.value.startsWith('urn:uuid:')",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PC_Bundle|1.0.1"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PC_Composition_Examination_Participation",
        type: PC.V1_0_1.Profile.PCCompositionExaminationParticipation,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PC_Encounter",
        type: PC.V1_0_1.Profile.PCEncounter,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PN_Bundle",
        type: PN.V1_0_1.Profile.PNBundle,
        version: "1.0.1",
        constraints: [
            {
                key: "bdl-7",
                severity: "error",
                human: "FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (except in history bundles)",
                expression:
                    "(type = 'history') or entry.where(fullUrl.exists()).select(fullUrl&resource.meta.versionId).isDistinct()",
                xpath: "(f:type/@value = 'history') or (count(for $entry in f:entry[f:resource] return $entry[count(parent::f:Bundle/f:entry[f:fullUrl/@value=$entry/f:fullUrl/@value and ((not(f:resource/*/f:meta/f:versionId/@value) and not($entry/f:resource/*/f:meta/f:versionId/@value)) or f:resource/*/f:meta/f:versionId/@value=$entry/f:resource/*/f:meta/f:versionId/@value)])!=1])=0)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-9",
                severity: "error",
                human: "A document must have an identifier with a system and a value",
                expression:
                    "type = 'document' implies (identifier.system.exists() and identifier.value.exists())",
                xpath: "not(f:type/@value = 'document') or exists(f:identifier/f:system) or exists(f:identifier/f:value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-3",
                severity: "error",
                human: "entry.request mandatory for batch/transaction/history, otherwise prohibited",
                expression:
                    "entry.all(request.exists() = (%resource.type = 'batch' or %resource.type = 'transaction' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:request) or (f:type/@value = 'batch') or (f:type/@value = 'transaction') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-4",
                severity: "error",
                human: "entry.response mandatory for batch-response/transaction-response/history, otherwise prohibited",
                expression:
                    "entry.all(response.exists() = (%resource.type = 'batch-response' or %resource.type = 'transaction-response' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:response) or (f:type/@value = 'batch-response') or (f:type/@value = 'transaction-response') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-12",
                severity: "error",
                human: "A message must have a MessageHeader as the first resource",
                expression:
                    "type = 'message' implies entry.first().resource.is(MessageHeader)",
                xpath: "not(f:type/@value='message') or f:entry[1]/f:resource/f:MessageHeader",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-1",
                severity: "error",
                human: "total only when a search or history",
                expression: "total.empty() or (type = 'searchset') or (type = 'history')",
                xpath: "not(f:total) or (f:type/@value = 'searchset') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-2",
                severity: "error",
                human: "entry.search only when a search",
                expression: "entry.search.empty() or (type = 'searchset')",
                xpath: "not(f:entry/f:search) or (f:type/@value = 'searchset')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-11",
                severity: "error",
                human: "A document must have a Composition as the first resource",
                expression:
                    "type = 'document' implies entry.first().resource.is(Composition)",
                xpath: "not(f:type/@value='document') or f:entry[1]/f:resource/f:Composition",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-10",
                severity: "error",
                human: "A document must have a date",
                expression: "type = 'document' implies (timestamp.hasValue())",
                xpath: "not(f:type/@value = 'document') or exists(f:timestamp/@value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "TypeComposition",
                severity: "error",
                human: "Es d√ºrfen nur Compositions der U-Untersuchungen bzw. der speziellen Fr√ºherkennungsuntersuchungen vorhanden sein",
                expression:
                    "entry.where(meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PN_Composition_Parental_Notes').isDistinct()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PN_Bundle"
            },
            {
                key: "OneComposition",
                severity: "error",
                human: "Es darf genau eine Composition geben",
                expression: "entry.where(ofType(Composition)).isDistinct()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PN_Bundle"
            },
            {
                key: "UUID",
                severity: "error",
                human: "Es soll eine UUID verwendet werden.",
                expression: "identifer.value.startsWith('urn:uuid:')",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PN_Bundle"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PN_Composition_Parental_Notes",
        type: PN.V1_0_1.Profile.PNCompositionParentalNotes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PN_Encounter",
        type: PN.V1_0_1.Profile.PNEncounter,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PN_Observation_Parental_Notes",
        type: PN.V1_0_1.Profile.PNObservationParentalNotes,
        version: "1.0.1",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_DPE_Composition_DPE",
        type: DPE.V1_0_0.Profile.DPECompositionDPE,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_DPE_Consent_Personal_Consent",
        type: DPE.V1_0_0.Profile.DPEConsentPersonalConsent,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "ppc-4",
                severity: "error",
                human: "IF Scope=adr, there must be a patient",
                expression:
                    "patient.exists() or scope.coding.where(system='something' and code='adr').exists().not()",
                xpath: "exists(f:patient) or not(exists(f:scope/f:coding[f:system/@value='something' and f:code/@value='adr'])))",
                source: "http://hl7.org/fhir/StructureDefinition/Consent"
            },
            {
                key: "ppc-5",
                severity: "error",
                human: "IF Scope=treatment, there must be a patient",
                expression:
                    "patient.exists() or scope.coding.where(system='something' and code='treatment').exists().not()",
                xpath: "exists(f:patient) or not(exists(f:scope/f:coding[f:system/@value='something' and f:code/@value='treatment'])))",
                source: "http://hl7.org/fhir/StructureDefinition/Consent"
            },
            {
                key: "ppc-2",
                severity: "error",
                human: "IF Scope=privacy, there must be a patient",
                expression:
                    "patient.exists() or scope.coding.where(system='something' and code='patient-privacy').exists().not()",
                xpath: "exists(f:patient) or not(exists(f:scope/f:coding[f:system/@value='something' and f:code/@value='patient-privacy'])))",
                source: "http://hl7.org/fhir/StructureDefinition/Consent"
            },
            {
                key: "ppc-3",
                severity: "error",
                human: "IF Scope=research, there must be a patient",
                expression:
                    "patient.exists() or scope.coding.where(system='something' and code='research').exists().not()",
                xpath: "exists(f:patient) or not(exists(f:scope/f:coding[f:system/@value='something' and f:code/@value='research'])))",
                source: "http://hl7.org/fhir/StructureDefinition/Consent"
            },
            {
                key: "ppc-1",
                severity: "error",
                human: "Either a Policy or PolicyRule",
                expression: "policy.exists() or policyRule.exists()",
                xpath: "exists(f:policy) or exists(f:policyRule)",
                source: "http://hl7.org/fhir/StructureDefinition/Consent"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_DPE_Patient_DPE",
        type: DPE.V1_0_0.Profile.DPEPatientDPE,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pat-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de').empty()",
                source: "http://fhir.de/StructureDefinition/Patient"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_DPE_Related_Person_Contact_Person",
        type: DPE.V1_0_0.Profile.DPERelatedPersonContactPerson,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFDxDPE_Bundle",
        type: NFDxDPE.V1_0_0.Profile.NFDxDPEBundle,
        version: "1.0.0",
        constraints: [
            {
                key: "bdl-7",
                severity: "error",
                human: "FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (except in history bundles)",
                expression:
                    "(type = 'history') or entry.where(fullUrl.exists()).select(fullUrl&resource.meta.versionId).isDistinct()",
                xpath: "(f:type/@value = 'history') or (count(for $entry in f:entry[f:resource] return $entry[count(parent::f:Bundle/f:entry[f:fullUrl/@value=$entry/f:fullUrl/@value and ((not(f:resource/*/f:meta/f:versionId/@value) and not($entry/f:resource/*/f:meta/f:versionId/@value)) or f:resource/*/f:meta/f:versionId/@value=$entry/f:resource/*/f:meta/f:versionId/@value)])!=1])=0)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-9",
                severity: "error",
                human: "A document must have an identifier with a system and a value",
                expression:
                    "type = 'document' implies (identifier.system.exists() and identifier.value.exists())",
                xpath: "not(f:type/@value = 'document') or exists(f:identifier/f:system) or exists(f:identifier/f:value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-3",
                severity: "error",
                human: "entry.request mandatory for batch/transaction/history, otherwise prohibited",
                expression:
                    "entry.all(request.exists() = (%resource.type = 'batch' or %resource.type = 'transaction' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:request) or (f:type/@value = 'batch') or (f:type/@value = 'transaction') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-4",
                severity: "error",
                human: "entry.response mandatory for batch-response/transaction-response/history, otherwise prohibited",
                expression:
                    "entry.all(response.exists() = (%resource.type = 'batch-response' or %resource.type = 'transaction-response' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:response) or (f:type/@value = 'batch-response') or (f:type/@value = 'transaction-response') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-12",
                severity: "error",
                human: "A message must have a MessageHeader as the first resource",
                expression:
                    "type = 'message' implies entry.first().resource.is(MessageHeader)",
                xpath: "not(f:type/@value='message') or f:entry[1]/f:resource/f:MessageHeader",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-1",
                severity: "error",
                human: "total only when a search or history",
                expression: "total.empty() or (type = 'searchset') or (type = 'history')",
                xpath: "not(f:total) or (f:type/@value = 'searchset') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-2",
                severity: "error",
                human: "entry.search only when a search",
                expression: "entry.search.empty() or (type = 'searchset')",
                xpath: "not(f:entry/f:search) or (f:type/@value = 'searchset')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-11",
                severity: "error",
                human: "A document must have a Composition as the first resource",
                expression:
                    "type = 'document' implies entry.first().resource.is(Composition)",
                xpath: "not(f:type/@value='document') or f:entry[1]/f:resource/f:Composition",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-10",
                severity: "error",
                human: "A document must have a date",
                expression: "type = 'document' implies (timestamp.hasValue())",
                xpath: "not(f:type/@value = 'document') or exists(f:timestamp/@value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "TypeComposition",
                severity: "error",
                human: "Es muss genau eine NFD- oder DPE-Composition vorhanden sein.",
                expression:
                    "entry.where (resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Composition_NFD|1.0.0' or resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_DPE_Composition_DPE|1.0.0'  ).count()=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFDxDPE_Bundle"
            },
            {
                key: "OneComposition",
                severity: "error",
                human: "Es darf nur eine Instanz vom Typ Composition enthalten sein",
                expression: "entry.select(resource as Composition).count()=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFDxDPE_Bundle"
            },
            {
                key: "OnePersonalConsent",
                severity: "error",
                human: "Es darf nur h√∂chstens eine pers√∂nliche Erkl√§rung vorhanden sein.",
                expression:
                    "entry.where(resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_DPE_Consent_Personal_Consent|1.0.0').count()<=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFDxDPE_Bundle"
            },
            {
                key: "OneActiveAdvanceDirective",
                severity: "error",
                human: "Es darf nur h√∂chstens eine Patientenverf√ºgung vorhanden sein.",
                expression:
                    "entry.where(resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFDxDPE_Consent_Active_Advance_Directive|1.0.0').count()<=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFDxDPE_Bundle"
            },
            {
                key: "OnePregnancyStatus",
                severity: "error",
                human: "Es darf nur h√∂chstens ein Schwangerschaftsstatus vorhanden sein.",
                expression:
                    "entry.where(resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Observation_Pregnancy_Status|1.0.0').count()<=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFDxDPE_Bundle"
            },
            {
                key: "OneCaculatedDeliveryDate",
                severity: "error",
                human: "Es darf nur h√∂chstens ein errechneter Entbindungstermin vorhanden sein.",
                expression:
                    "entry.where(resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Observation_Pregnancy_Calculated_Delivery_Date|1.0.0').count()<=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFDxDPE_Bundle"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFDxDPE_Consent_Active_Advance_Directive",
        type: NFDxDPE.V1_0_0.Profile.NFDxDPEConsentActiveAdvanceDirective,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "ppc-4",
                severity: "error",
                human: "IF Scope=adr, there must be a patient",
                expression:
                    "patient.exists() or scope.coding.where(system='something' and code='adr').exists().not()",
                xpath: "exists(f:patient) or not(exists(f:scope/f:coding[f:system/@value='something' and f:code/@value='adr'])))",
                source: "http://hl7.org/fhir/StructureDefinition/Consent"
            },
            {
                key: "ppc-5",
                severity: "error",
                human: "IF Scope=treatment, there must be a patient",
                expression:
                    "patient.exists() or scope.coding.where(system='something' and code='treatment').exists().not()",
                xpath: "exists(f:patient) or not(exists(f:scope/f:coding[f:system/@value='something' and f:code/@value='treatment'])))",
                source: "http://hl7.org/fhir/StructureDefinition/Consent"
            },
            {
                key: "ppc-2",
                severity: "error",
                human: "IF Scope=privacy, there must be a patient",
                expression:
                    "patient.exists() or scope.coding.where(system='something' and code='patient-privacy').exists().not()",
                xpath: "exists(f:patient) or not(exists(f:scope/f:coding[f:system/@value='something' and f:code/@value='patient-privacy'])))",
                source: "http://hl7.org/fhir/StructureDefinition/Consent"
            },
            {
                key: "ppc-3",
                severity: "error",
                human: "IF Scope=research, there must be a patient",
                expression:
                    "patient.exists() or scope.coding.where(system='something' and code='research').exists().not()",
                xpath: "exists(f:patient) or not(exists(f:scope/f:coding[f:system/@value='something' and f:code/@value='research'])))",
                source: "http://hl7.org/fhir/StructureDefinition/Consent"
            },
            {
                key: "ppc-1",
                severity: "error",
                human: "Either a Policy or PolicyRule",
                expression: "policy.exists() or policyRule.exists()",
                xpath: "exists(f:policy) or exists(f:policyRule)",
                source: "http://hl7.org/fhir/StructureDefinition/Consent"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Allergy_Intolerance",
        type: NFD.V1_0_0.Profile.NFDAllergyIntolerance,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "ait-1",
                severity: "error",
                human: "AllergyIntolerance.clinicalStatus SHALL be present if verificationStatus is not entered-in-error.",
                expression:
                    "verificationStatus.coding.where(system = 'http://terminology.hl7.org/CodeSystem/allergyintolerance-verification' and code = 'entered-in-error').exists() or clinicalStatus.exists()",
                xpath: "f:verificationStatus/f:coding/f:code/@value='entered-in-error' or exists(f:clinicalStatus)",
                source: "http://hl7.org/fhir/StructureDefinition/AllergyIntolerance"
            },
            {
                key: "ait-2",
                severity: "error",
                human: "AllergyIntolerance.clinicalStatus SHALL NOT be present if verification Status is entered-in-error",
                expression:
                    "verificationStatus.coding.where(system = 'http://terminology.hl7.org/CodeSystem/allergyintolerance-verification' and code = 'entered-in-error').empty() or clinicalStatus.empty()",
                xpath: "not(f:verificationStatus/f:coding/f:code/@value='entered-in-error') or not(exists(f:clinicalStatus))",
                source: "http://hl7.org/fhir/StructureDefinition/AllergyIntolerance"
            },
            {
                key: "all-1",
                severity: "error",
                human: "onsetPeriod.start must at least contain a year",
                expression:
                    "onsetPeriod.start.exists() implies onsetPeriod.start.toString().length() >= 4",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Allergy_Intolerance"
            },
            {
                key: "all-2",
                severity: "error",
                human: "OnsetPeriod.end must at least contain a year.",
                expression:
                    "onsetPeriod.end.exists() implies onsetPeriod.end.toString().length() >= 4",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Allergy_Intolerance"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Composition_NFD",
        type: NFD.V1_0_0.Profile.NFDCompositionNFD,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Condition",
        type: NFD.V1_0_0.Profile.NFDCondition,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "con-5",
                severity: "error",
                human: "Condition.clinicalStatus SHALL NOT be present if verification Status is entered-in-error",
                expression:
                    "verificationStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-ver-status' and code='entered-in-error').empty() or clinicalStatus.empty()",
                xpath: "not(exists(f:verificationStatus/f:coding[f:system/@value='http://terminology.hl7.org/CodeSystem/condition-ver-status' and f:code/@value='entered-in-error'])) or not(exists(f:clinicalStatus))",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                key: "con-4",
                severity: "error",
                human: "If condition is abated, then clinicalStatus must be either inactive, resolved, or remission",
                expression:
                    "abatement.empty() or clinicalStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-clinical' and (code='resolved' or code='remission' or code='inactive')).exists()",
                xpath: "not(exists(*[starts-with(local-name(.), 'abatement')])) or exists(f:clinicalStatus/f:coding[f:system/@value='http://terminology.hl7.org/CodeSystem/condition-clinical' and f:code/@value=('resolved', 'remission', 'inactive')])",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "Most systems will expect a clinicalStatus to be valued for problem-list-items that are managed over time, but might not need a clinicalStatus for point in time encounter-diagnosis."
                    }
                ],
                key: "con-3",
                severity: "warning",
                human: "Condition.clinicalStatus SHALL be present if verificationStatus is not entered-in-error and category is problem-list-item",
                expression:
                    "clinicalStatus.exists() or verificationStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-ver-status' and code = 'entered-in-error').exists() or category.select($this='problem-list-item').empty()",
                xpath: "exists(f:clinicalStatus) or exists(f:verificationStatus/f:coding/f:code/@value='entered-in-error') or not(exists(category[@value='problem-list-item']))",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                key: "Rec1",
                severity: "warning",
                human: "Das Dokumentationsdatum soll mindestens mit MM.JJJJ angegeben werden.",
                expression:
                    "recordedDate.exists() implies recordedDate.toString().length()>=7",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_Base_Diagnosis"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Condition_Communication_Disorder",
        type: NFD.V1_0_0.Profile.NFDConditionCommunicationDisorder,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "con-5",
                severity: "error",
                human: "Condition.clinicalStatus SHALL NOT be present if verification Status is entered-in-error",
                expression:
                    "verificationStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-ver-status' and code='entered-in-error').empty() or clinicalStatus.empty()",
                xpath: "not(exists(f:verificationStatus/f:coding[f:system/@value='http://terminology.hl7.org/CodeSystem/condition-ver-status' and f:code/@value='entered-in-error'])) or not(exists(f:clinicalStatus))",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                key: "con-4",
                severity: "error",
                human: "If condition is abated, then clinicalStatus must be either inactive, resolved, or remission",
                expression:
                    "abatement.empty() or clinicalStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-clinical' and (code='resolved' or code='remission' or code='inactive')).exists()",
                xpath: "not(exists(*[starts-with(local-name(.), 'abatement')])) or exists(f:clinicalStatus/f:coding[f:system/@value='http://terminology.hl7.org/CodeSystem/condition-clinical' and f:code/@value=('resolved', 'remission', 'inactive')])",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "Most systems will expect a clinicalStatus to be valued for problem-list-items that are managed over time, but might not need a clinicalStatus for point in time encounter-diagnosis."
                    }
                ],
                key: "con-3",
                severity: "warning",
                human: "Condition.clinicalStatus SHALL be present if verificationStatus is not entered-in-error and category is problem-list-item",
                expression:
                    "clinicalStatus.exists() or verificationStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-ver-status' and code = 'entered-in-error').exists() or category.select($this='problem-list-item').empty()",
                xpath: "exists(f:clinicalStatus) or exists(f:verificationStatus/f:coding/f:code/@value='entered-in-error') or not(exists(category[@value='problem-list-item']))",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                key: "cond-1",
                severity: "error",
                human: "If Evidence.code.coding does not exist, Evidence.code.text SHALL exist",
                expression:
                    "evidence.code.coding.exists().not() implies evidence.code.text.exists()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Condition_Communication_Disorder"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Condition_Runaway_Risk",
        type: NFD.V1_0_0.Profile.NFDConditionRunawayRisk,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "con-5",
                severity: "error",
                human: "Condition.clinicalStatus SHALL NOT be present if verification Status is entered-in-error",
                expression:
                    "verificationStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-ver-status' and code='entered-in-error').empty() or clinicalStatus.empty()",
                xpath: "not(exists(f:verificationStatus/f:coding[f:system/@value='http://terminology.hl7.org/CodeSystem/condition-ver-status' and f:code/@value='entered-in-error'])) or not(exists(f:clinicalStatus))",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                key: "con-4",
                severity: "error",
                human: "If condition is abated, then clinicalStatus must be either inactive, resolved, or remission",
                expression:
                    "abatement.empty() or clinicalStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-clinical' and (code='resolved' or code='remission' or code='inactive')).exists()",
                xpath: "not(exists(*[starts-with(local-name(.), 'abatement')])) or exists(f:clinicalStatus/f:coding[f:system/@value='http://terminology.hl7.org/CodeSystem/condition-clinical' and f:code/@value=('resolved', 'remission', 'inactive')])",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "Most systems will expect a clinicalStatus to be valued for problem-list-items that are managed over time, but might not need a clinicalStatus for point in time encounter-diagnosis."
                    }
                ],
                key: "con-3",
                severity: "warning",
                human: "Condition.clinicalStatus SHALL be present if verificationStatus is not entered-in-error and category is problem-list-item",
                expression:
                    "clinicalStatus.exists() or verificationStatus.coding.where(system='http://terminology.hl7.org/CodeSystem/condition-ver-status' and code = 'entered-in-error').exists() or category.select($this='problem-list-item').empty()",
                xpath: "exists(f:clinicalStatus) or exists(f:verificationStatus/f:coding/f:code/@value='entered-in-error') or not(exists(category[@value='problem-list-item']))",
                source: "http://hl7.org/fhir/StructureDefinition/Condition"
            },
            {
                key: "cond-1",
                severity: "error",
                human: "If Evidence.code.coding does not exist, Evidence.code.text SHALL exist",
                expression:
                    "evidence.code.coding.exists().not() implies evidence.code.text.exists()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Condition_Runaway_Risk"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Device_Implant",
        type: NFD.V1_0_0.Profile.NFDDeviceImplant,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Device_Use_Statement_Implant",
        type: NFD.V1_0_0.Profile.NFDDeviceUseStatementImplant,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "DUS-1",
                severity: "error",
                human: "The date, the device was implanted, must at least consist of a year",
                expression:
                    "timingPeriod.start.exists() implies timingPeriod.start.toString().length() >= 4",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Device_Use_Statement_Implant"
            },
            {
                key: "DUS-2",
                severity: "error",
                human: "The date, the device was removed, must at least consist of a year",
                expression:
                    "timingPeriod.end.exists() implies timingPeriod.end.toString().length() >= 4",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Device_Use_Statement_Implant"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Medication",
        type: NFD.V1_0_0.Profile.NFDMedication,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Medication_Recipe",
        type: NFD.V1_0_0.Profile.NFDMedicationRecipe,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Medication_Statement_Administration_Instruction",
        type: NFD.V1_0_0.Profile.NFDMedicationStatementAdministrationInstruction,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Observation_Note",
        type: NFD.V1_0_0.Profile.NFDObservationNote,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-1",
                severity: "error",
                human: "If valueCodeableConcept does not exist, valueString SHALL exist",
                expression:
                    "valueCodeableConcept.exists().not() implies valueString.exists()",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Observation_Note"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Observation_Pregnancy_Calculated_Delivery_Date",
        type: NFD.V1_0_0.Profile.NFDObservationPregnancyCalculatedDeliveryDate,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-1",
                severity: "error",
                human: "Delivery date must at least consist of year, month and day",
                expression: "valueDateTime.toString().length() >= 10",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Observation_Pregnancy_Calculated_Delivery_Date"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Observation_Pregnancy_Status",
        type: NFD.V1_0_0.Profile.NFDObservationPregnancyStatus,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Observation_Voluntary_Additional_Information",
        type: NFD.V1_0_0.Profile.NFDObservationVoluntaryAdditionalInformation,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "obs-7",
                severity: "error",
                human: "If Observation.code is the same as an Observation.component.code then the value element associated with the code SHALL NOT be present",
                expression:
                    "value.empty() or component.code.where(coding.intersect(%resource.code.coding).exists()).empty()",
                xpath: "not(f:*[starts-with(local-name(.), 'value')] and (for $coding in f:code/f:coding return f:component/f:code/f:coding[f:code/@value=$coding/f:code/@value] [f:system/@value=$coding/f:system/@value]))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            },
            {
                key: "obs-6",
                severity: "error",
                human: "dataAbsentReason SHALL only be present if Observation.value[x] is not present",
                expression: "dataAbsentReason.empty() or value.empty()",
                xpath: "not(exists(f:dataAbsentReason)) or (not(exists(*[starts-with(local-name(.), 'value')])))",
                source: "http://hl7.org/fhir/StructureDefinition/Observation"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Organization",
        type: NFD.V1_0_0.Profile.NFDOrganization,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "org-1",
                severity: "error",
                human: "The organization SHALL at least have a name or an identifier, and possibly more than one",
                expression: "(identifier.count() + name.count()) > 0",
                xpath: "count(f:identifier | f:name) > 0",
                source: "http://hl7.org/fhir/StructureDefinition/Organization"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Patient_NFD",
        type: NFD.V1_0_0.Profile.NFDPatientNFD,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pat-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de').empty()",
                source: "http://fhir.de/StructureDefinition/Patient"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Practitioner",
        type: NFD.V1_0_0.Profile.NFDPractitioner,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pract-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de/0.2').empty()",
                source: "http://fhir.de/StructureDefinition/Practitioner"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Practitioner_Physician",
        type: NFD.V1_0_0.Profile.NFDPractitionerPhysician,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "pract-de-1",
                severity: "error",
                human: "Die amtliche Differenzierung der Geschlechtsangabe 'other' darf nur gef√ºllt sein, wenn das Geschlecht 'other' angegeben ist",
                expression:
                    "gender='other' or gender.extension('http://fhir.de/StructureDefinition/gender-amtlich-de/0.2').empty()",
                source: "http://fhir.de/StructureDefinition/Practitioner"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Practitioner_Role",
        type: NFD.V1_0_0.Profile.NFDPractitionerRole,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile:
            "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Practitioner_Role_With_Organization",
        type: NFD.V1_0_0.Profile.NFDPractitionerRoleWithOrganization,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_NFD_Procedure",
        type: NFD.V1_0_0.Profile.NFDProcedure,
        version: "1.0.0",
        constraints: [
            {
                key: "dom-2",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL NOT contain nested Resources",
                expression: "contained.contained.empty()",
                xpath: "not(parent::f:contained and f:contained)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-4",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a meta.versionId or a meta.lastUpdated",
                expression:
                    "contained.meta.versionId.empty() and contained.meta.lastUpdated.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:versionId)) and not(exists(f:contained/*/f:meta/f:lastUpdated))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-3",
                severity: "error",
                human: "If the resource is contained in another resource, it SHALL be referred to from elsewhere in the resource or SHALL refer to the containing resource",
                expression:
                    "contained.where((('#'+id in (%resource.descendants().reference | %resource.descendants().as(canonical) | %resource.descendants().as(uri) | %resource.descendants().as(url))) or descendants().where(reference = '#').exists() or descendants().where(as(canonical) = '#').exists() or descendants().where(as(canonical) = '#').exists()).not()).trace('unmatched', id).empty()",
                xpath: "not(exists(for $id in f:contained/*/f:id/@value return $contained[not(parent::*/descendant::f:reference/@value=concat('#', $contained/*/id/@value) or descendant::f:reference[@value='#'])]))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                extension: [
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice",
                        valueBoolean: true
                    },
                    {
                        url: "http://hl7.org/fhir/StructureDefinition/elementdefinition-bestpractice-explanation",
                        valueMarkdown:
                            "When a resource has no narrative, only systems that fully understand the data can display the resource to a human safely. Including a human readable representation in the resource makes for a much more robust eco-system and cheaper handling of resources by intermediary systems. Some ecosystems restrict distribution of resources to only those systems that do fully understand the resources, and as a consequence implementers may believe that the narrative is superfluous. However experience shows that such eco-systems often open up to new participants over time."
                    }
                ],
                key: "dom-6",
                severity: "warning",
                human: "A resource should have narrative for robust management",
                expression: "text.`div`.exists()",
                xpath: "exists(f:text/h:div)",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            },
            {
                key: "dom-5",
                severity: "error",
                human: "If a resource is contained in another resource, it SHALL NOT have a security label",
                expression: "contained.meta.security.empty()",
                xpath: "not(exists(f:contained/*/f:meta/f:security))",
                source: "http://hl7.org/fhir/StructureDefinition/DomainResource"
            }
        ]
    },
    {
        profile: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PS_Bundle",
        type: PS.V1_0_0.Profile.Bundle,
        version: "1.0.0",
        constraints: [
            {
                key: "bdl-7",
                severity: "error",
                human: "FullUrl must be unique in a bundle, or else entries with the same fullUrl must have different meta.versionId (except in history bundles)",
                expression:
                    "(type = 'history') or entry.where(fullUrl.exists()).select(fullUrl&resource.meta.versionId).isDistinct()",
                xpath: "(f:type/@value = 'history') or (count(for $entry in f:entry[f:resource] return $entry[count(parent::f:Bundle/f:entry[f:fullUrl/@value=$entry/f:fullUrl/@value and ((not(f:resource/*/f:meta/f:versionId/@value) and not($entry/f:resource/*/f:meta/f:versionId/@value)) or f:resource/*/f:meta/f:versionId/@value=$entry/f:resource/*/f:meta/f:versionId/@value)])!=1])=0)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-9",
                severity: "error",
                human: "A document must have an identifier with a system and a value",
                expression:
                    "type = 'document' implies (identifier.system.exists() and identifier.value.exists())",
                xpath: "not(f:type/@value = 'document') or exists(f:identifier/f:system) or exists(f:identifier/f:value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-3",
                severity: "error",
                human: "entry.request mandatory for batch/transaction/history, otherwise prohibited",
                expression:
                    "entry.all(request.exists() = (%resource.type = 'batch' or %resource.type = 'transaction' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:request) or (f:type/@value = 'batch') or (f:type/@value = 'transaction') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-4",
                severity: "error",
                human: "entry.response mandatory for batch-response/transaction-response/history, otherwise prohibited",
                expression:
                    "entry.all(response.exists() = (%resource.type = 'batch-response' or %resource.type = 'transaction-response' or %resource.type = 'history'))",
                xpath: "not(f:entry/f:response) or (f:type/@value = 'batch-response') or (f:type/@value = 'transaction-response') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-12",
                severity: "error",
                human: "A message must have a MessageHeader as the first resource",
                expression:
                    "type = 'message' implies entry.first().resource.is(MessageHeader)",
                xpath: "not(f:type/@value='message') or f:entry[1]/f:resource/f:MessageHeader",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-1",
                severity: "error",
                human: "total only when a search or history",
                expression: "total.empty() or (type = 'searchset') or (type = 'history')",
                xpath: "not(f:total) or (f:type/@value = 'searchset') or (f:type/@value = 'history')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-2",
                severity: "error",
                human: "entry.search only when a search",
                expression: "entry.search.empty() or (type = 'searchset')",
                xpath: "not(f:entry/f:search) or (f:type/@value = 'searchset')",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-11",
                severity: "error",
                human: "A document must have a Composition as the first resource",
                expression:
                    "type = 'document' implies entry.first().resource.is(Composition)",
                xpath: "not(f:type/@value='document') or f:entry[1]/f:resource/f:Composition",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "bdl-10",
                severity: "error",
                human: "A document must have a date",
                expression: "type = 'document' implies (timestamp.hasValue())",
                xpath: "not(f:type/@value = 'document') or exists(f:timestamp/@value)",
                source: "http://hl7.org/fhir/StructureDefinition/Bundle"
            },
            {
                key: "TypeComposition",
                severity: "error",
                human: "Es muss genau eine Patientenkurzakten Composition vorhanden sein",
                expression:
                    "entry.where (resource.meta.profile='https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PS_Composition|1.0.0').count()=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PS_Bundle"
            },
            {
                key: "OneComposition",
                severity: "error",
                human: "Es darf nur eine Instanz vom Typ Composition enthalten sein",
                expression: "entry.select(resource as Composition).count()=1",
                source: "https://fhir.kbv.de/StructureDefinition/KBV_PR_MIO_PS_Bundle"
            }
        ]
    }
];
